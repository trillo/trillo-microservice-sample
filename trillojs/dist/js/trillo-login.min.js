/*!
 * TrilloJS v0.5.0 (https://github.com/trillo/trillojs#readme)
 * Copyright 2017 Collager Inc.
 * Licensed under the MIT license
 */
!function(){"use strict";jQuery.fn.extend({dataOrAttr:function(a){return this.data(a)||this.attr(a)}})}();var Trillo={appLocation:"",OBJ_LOCKED:3,TrilloApp:{},appNamespace:null,isTouchSurface:!1};!function(){"use strict";Trillo.AppInitializer=function(){this.WIDTH_A=800,this.WIDTH_B=720,this.WIDTH_C=640,this.WIDTH_D=480,this.WIDTH_E=320};var a=Trillo.AppInitializer.prototype;a.initApp=function(a){this.cb=a,this.createAlertComponent(),this.createLogComponent(),this.createSearchHandler(),this.createBuilder(),this.createViewManager(),this.createModelFactory(),this.createApiAdapterFactory(),this.createObserverFactory(),this.createPage(),this.createRouter(),this.createTitleBarManager(),this.createContextMenuManager(),this.createPopoverMananger(),this.doCallback()},a.doCallback=function(){this.cb()},a.createAlertComponent=function(){Trillo.Alert&&(Trillo.alert=new Trillo.Alert)},a.createLogComponent=function(){Trillo.Log&&(Trillo.log=new Trillo.Log)},a.createSearchHandler=function(){Trillo.SearchHandler&&(Trillo.searchHandler=new Trillo.SearchHandler)},a.createViewManager=function(){Trillo.ViewManager&&(Trillo.viewManager=new Trillo.ViewManager)},a.createBuilder=function(){Trillo.Builder&&(Trillo.builder=new Trillo.Builder)},a.createModelFactory=function(){Trillo.ModelFactory&&(Trillo.modelFactory=new Trillo.ModelFactory)},a.createApiAdapterFactory=function(){Trillo.ApiAdapterFactory&&(Trillo.apiAdapterFactory=new Trillo.ApiAdapterFactory)},a.createObserverFactory=function(){Trillo.ObserverFactory&&(Trillo.observerFactory=new Trillo.ObserverFactory)},a.createPage=function(){Trillo.Page&&(Trillo.page=new Trillo.Page)},a.createRouter=function(){Trillo.Router&&(Trillo.router=new Trillo.Router)},a.createTitleBarManager=function(){Trillo.TitleBarManager&&(Trillo.titleBarManager=new Trillo.TitleBarManager)},a.createContextMenuManager=function(){Trillo.ContextMenuManager&&(Trillo.contextMenuManager=new Trillo.ContextMenuManager)},a.createPopoverMananger=function(){Trillo.PopoverManager&&(Trillo.popoverManager=new Trillo.PopoverManager)},Trillo.Options={V_MARGIN_TOP_ROW:10,V_MARGIN:20,H_MARGIN:20,BOTTOM_SPACE_FOR_INF_SCROLL:60,OPEN_ALL:"openAll",CLOSE_ALL:"closeAll",SCROLL_ON_HOVER:"scrollOnHover",AUTO_SCROLL:"autoScroll",SMOOTH_SCROLL:"smoothScroll",NO_SCROLL:"noScroll",NON_NATIVE_SCROLLBAR:"nonNativeScrollBar",DIALOG_MAX_WIDTH:"400px"},Trillo.Config={viewFileExtension:"",viewPath:null,basePath:null,pagePath:null},Trillo.HtmlTemplates={titleBarTitlePrefix:'<li nm="{{viewName}}-title-prefix">{{titlePrefix}}</li>',titleBarTitle:'<li nm="{{viewName}}-title">{{title}}</li>',titleBarTitlePrefix2:'<span nm="{{viewName}}-title-prefix">{{titlePrefix}}</span>',titleBarTitle2:'<span nm="{{viewName}}-title">{{title}}</span>',dropdownListItem:'<li><a class="js-list-item" nm="{{uid}}" href="#">{{name}}</a></li>'},Trillo.inherits=function(a,b){return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b}}(),Trillo.CSS={alertDanger:"alert-danger",alertSuccess:"alert-success",pointed:"trillo-pointed fa fa-hand-o-right",hasErrorCss:"trillo-has-error",hasMessageCss:"trillo-has-message",positionOutside:"trillo-position-outside",selected:"trillo-selected",appRready:"trillo-app-ready",tabActive:"active",treeItemTn:"trillo-tree-item-tn",tnLabel:"trillo-tn-label",treeNode:"tree-node",treeNodeLevelPrefix:"lvl",treeItem:"trillo-tree-item",itemClose:"trillo-item-close",itemOpen:"trillo-item-open",containerPreviewMode:"trillo-container-preview-mode",containerMark:"trillo-container-mark",buttonGroup:"btn-group",dropdown:"dropdown",buttonGroupOpen:"open",dropdownOpen:"open",fieldMsg:"trillo-field-msg"},function(){"use strict";Trillo.isNumeric=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},Trillo.isArray=function(a){return $.isArray(a)},Trillo.isObject=function(a){return $.isPlainObject(a)},Trillo.getAllClasses=function(a,b){var c=a.attr("class");return c?b&&(c=c.replace(b,"")):c="",c},Trillo.getRefByQualifiedName=function(a){for(var b=a.split("."),c=b.length,d=0,e=window;e&&c>d;)e=e[b[d++]];return e},Trillo.KeyValue=function(){this.l=[]};var a=Trillo.KeyValue.prototype;a.add=function(a,b){this.l.push({k:a,v:b})},a.getValue=function(a){for(var b=this.l,c=0;c<b.length;c++)if(b[c].k===a)return b[c].v;return null},Trillo.uid=function(a){var b,c=a._uid_;return c?c:(c=a._id_,c?(b=a._class_,b?b+"."+c:c):a.uid?a.uid:a.name)},Trillo.uidToClass=function(a){var b,c=null;return a&&(b=a.indexOf("."),b>0&&(c=a.substring(0,b))),c},Trillo.uidToId=function(a){var b,c=null;return a&&(b=a.indexOf("."),b>0&&(c=a.substring(b+1))),c},Trillo.isUid=function(a){if(a){var b=a.indexOf(".");return b>0}return!1},Trillo.offsetByFixedAbsolute=function(a){var b,c=0;a.prevAll().each(function(){b=$(this).css("position"),("fixed"===b||"absolute"===b)&&(c+=$(this).outerHeight())}),a.css("margin-top",c)},Trillo.showBusy=function(){$(".js-busy-indicator").show().css("visibility","visible")},Trillo.hideBusy=function(){$(".js-busy-indicator").css("visibility","hidden")},Trillo.elemId=0,Trillo.getUniqueElemId=function(){return this.elemId++,"_trillo_e_"+this.elemId},Trillo.getObjectValue=function(a,b){if(b&&0!==b.length)for(var c=b.split("."),d=0;d<c.length&&(a=a[c[d]],a);d++);return void 0===a||null===a?null:a},Trillo.setObjectValue=function(a,b,c){for(var d=b.split("."),e=a,f=0;f<d.length-1;f++)e=a[d[f]],e||(e={},a[d[f]]=e),a=e;b=d[d.length-1],a[b]=c},Trillo.mergeObject=function(a,b,c){for(var d=b.split("."),e=a,f=0;f<d.length-1;f++)""!==d[f]&&(e=a[d[f]],e||(e={},a[d[f]]=e),a=e);b=d[d.length-1],""===b?$.extend(a,c):a[b]=c},Trillo.formatValue=function(a,b,c){if(!b||""===b)return c?"":"&nbsp;";var d=a.dataOrAttr("display-type"),e=a.dataOrAttr("enum-name");if(d){if("date"===d||"time"===d||"datetime"===d)return this.formatDate(a,b);if(e)return this.getEnumName(a,b)}return b},Trillo.formatDate=function(a,b){var c=a.dataOrAttr("format")||"M/D/YY hh:mm:ss A";return moment(b).format(c)},Trillo.getEnumName=function(a,b){var c=a.dataOrAttr("enum-name");return Trillo.enumCatalog.getName(c,b)},Trillo.setCookieValue=function(a,b,c){var d,e;if(c){var f=new Date;f.setTime(f.getTime()+24*c*60*60*1e3),d="; expires="+f.toGMTString()}else d="";e=b+d+"; path=/";var g=this.getCookieDomain();g&&(e+=";domain="+g),document.cookie=a+"="+e},Trillo.getCookieValue=function(a){a+="=";var b=document.cookie.indexOf(a);if(b>=0){var c=document.cookie.substring(b+a.length);return b=c.indexOf(";"),0>b&&(b=c.length),c=c.substring(0,b),unescape(c)}return""},Trillo.deleteCookie=function(a){""!==Trillo.getCookieValue(a)&&(document.cookie=a+"=;expires=Thu, 01-Jan-1970 00:00:01 GMT")},Trillo.getCookieDomain=function(){var a=document.domain;if(!a||""===a)return null;var b=null,c=a.lastIndexOf(".");if(c>0){var d=a.substring(0,c),e=a.substring(c);c=d.lastIndexOf("."),c>=0?(d=d.substring(c),b=d+e):b="."+d+e}return b},Trillo.matches=function(a,b,c){var d;for(d in a)if("undefined"==typeof b[d]&&"undefined"!=typeof a[d])return!1;for(d in a)if(a[d])switch(typeof a[d]){case"object":if(c){if(!Trillo.matches(a[d],b[d]))return!1}else if(a[d]!==b[d])return!1;break;case"function":break;default:if(a[d]!==b[d])return!1}else if(b[d])return!1;for(d in b)if("undefined"==typeof a[d])return!1;return!0},Trillo.replacer=function(a,b){return 0===a.indexOf("_trillo_")?void 0:b},Trillo.stringify=function(a){return JSON.stringify(a,Trillo.replacer)},Trillo.getSpecObject=function(a,b){function c(a){var b=a.html(),c=null;if(b&&b.length)try{c=$.parseJSON(b)}catch(d){Trillo.log.error("Failed to parse view spec JSON: "+d.message+"<br/>"+b)}return c}function d(a,b){for(var c=0;c<a.length;c++)if(a[c].name===b)return a[c];return null}var e=a.find(b);if(0===e.length)return null;var f=e.length>0?$(e[0]):e,g=c(f);if(g&&e.length>1)for(var h=1;h<e.length;h++){var i=c($(e[h]));if(null!==i){i.embedded=!0,g.nextViewSpecs||(g.nextViewSpecs=[]);var j=d(g.nextViewSpecs,i.name);j?$.extend(j,i):g.nextViewSpecs.push(i)}}return e.remove(),g},Trillo.getNearestInDOMTree=function(a,b){for(var c=a.find(b);0===c.length&&a.length&&"html"!==(a.prop("nodeName")||"").toLowerCase();)a=a.parent(),c=a.find(b);return c},Trillo.getTriggerFromPath=function(a){var b=a.indexOf(":");return b>=0?a.substring(0,b):a},Trillo.getViewNameFromPath=function(a){var b=a.indexOf(":");return b>=0?a.substring(b+1):a},Trillo.clearObj=function(a){var b;for(b in a)delete a[b]},Trillo.endsWith=function(a,b){return a.length<b.length?!1:a.lastIndexOf(b)===a.length-b.length},Trillo.deleteFromArray=function(a,b){var c=a.indexOf(b);c>=0&&a.splice(c,1)},Trillo.findByProp=function(a,b,c){if(a)for(var d=0;d<a.length;d++)if(a[d][b]===c)return a[d];return null},Trillo.endsWith=function(a,b){return a&&b?-1!==a.indexOf(b,a.length-b.length):!1},Trillo.endsWithIgnoreCase=function(a,b){return a&&b?(a=a.toLowerCase(),b=b.toLowerCase(),-1!==a.indexOf(b,a.length-b.length)):!1},Trillo.setCSRFCookieHeader=function(a,b){function c(a){return a?(a^16*Math.random()>>a/4).toString(16):([1e16]+1e16).replace(/[01]/g,c)}var d="X-CSRF-TOKEN",e="CSRF-TOKEN",f=$("meta[name='_csrf']").attr("content"),g=$("meta[name='_csrf_header']").attr("content");g&&f?a.setRequestHeader(g,f):(f=Trillo.getCookieValue(e),(b||!f)&&(f=c(),Trillo.setCookieValue(e,f)),a.setRequestHeader(d,f))}}(),function(){"use strict";Trillo.Storage=function(a){this.storage=a};var a=Trillo.Storage.prototype;a.setItem=function(a,b){b="string"==typeof b?b:JSON.stringify(b),this.storage.setItem(a,b)},a.getItem=function(a){return this.storage.getItem(a)},a.getItemAsObj=function(a){var b=this.storage.getItem(a);return b?JSON.parse(b):b},a.removeItem=function(a){this.storage.removeItem(a)},a.clear=function(){var a,b=[];for(a=0;a<this.storage.length;a++)b.push(this.storage.key(a));for(a=0;a<b.length;a++)this.removeItem(b[a])},a.removeAllStartingWith=function(a){var b,c=[];for(b=0;b<this.storage.length;b++)0===this.storage.key(b).indexOf(a)&&c.push(this.storage.key(b));for(b=0;b<c.length;b++)this.removeItem(c[b])},Trillo.sessionStorage=new Trillo.Storage(sessionStorage),Trillo.localStorage=new Trillo.Storage(localStorage)}(),function(){"use strict";Trillo.NavHistory=function(){};var a=Trillo.NavHistory.prototype;a.add=function(a,b,c){console.log("NavHistory.add(): "+a+" -> "+b),Trillo.localStorage.setItem(a,b),c?Trillo.localStorage.setItem("params://"+Trillo.getFullPath(a,b),c):Trillo.localStorage.removeItem("params://"+Trillo.getFullPath(a,b))},a.get=function(a){if(this.isDisabled())return null;var b=Trillo.localStorage.getItem(a);return console.log("NavHistory.get(): "+a+" -> "+b),b},a.remove=function(a){return this.isDisabled()?null:(console.log("NavHistory.remove(): "+a),void Trillo.localStorage.removeItem(a))},a.getParams=function(a,b,c){if(this.isDisabled())return null;var d=Trillo.localStorage.getItem("params://"+Trillo.getFullPath(a,b));return console.log("NavHistory.getParams(): "+a+"/"+b+"?"+d),d},a.setDisabled=function(a){Trillo.sessionStorage.setItem("_nav_history_disabled",""+a)},a.isDisabled=function(){return"true"===Trillo.sessionStorage.getItem("_nav_history_disabled")}}(),Trillo.navHistory=new Trillo.NavHistory,function(){"use strict";Trillo.Alert=function(){this.$e=$(".js-alert"),this.$t=this.$e.find(".js-title"),this.$m=this.$e.find(".js-message"),this.fo=$.proxy(this.fadeOut,this),this.actionM=$.proxy(this.doAction,this),this.initActionHandler()};var a=Trillo.Alert.prototype;a.initActionHandler=function(){this.$e.find('[nm="close"]').off("click",this.actionM).on("click",this.actionM)},a.show=function(a,b,c,d){this.$e.removeClass(Trillo.CSS.alertDanger).addClass(Trillo.CSS.alertSuccess),this._show(a,b,c,d)},a.showError=function(a,b,c,d){this.$e.removeClass(Trillo.CSS.alertSuccess).addClass(Trillo.CSS.alertDanger),this._show(a,b,c,d)},a._show=function(a,b,c,d){this.$e.finish(),d?this.$e.css("left",d.offset().left+Math.floor(d.width()/2)):this.$e.css("left",0),this.$t.html(a),b=b.replace(/(?:\r\n|\r|\n)/g,"<br />"),this.$m.html(b),this.$e.hide(),this.$e.fadeIn(1e3,c?this.fo:null)},a.fadeOut=function(a){this.$e.fadeOut(8e3)},a.doAction=function(a){if(a){a.stopPropagation();var b=$(a.target).dataOrAttr("nm");"close"===b&&this.clear()}},a.clear=function(a){this.$e.finish(),this.$e.hide()},a.notYetImplemented=function(a){this.showError("Not Implemented","Action '"+a+"' is not yet implemented",!0)}}(),function(){"use strict";Trillo.BaseController=function(a){this.viewSpec=a,this.name=a.name,this._view=null,this._model=null,this._parentController=null,this._nextController=null,this._embeddedControllers=[],this._bizDelegate=null,this.viewsInFlight={}};var a=Trillo.BaseController.prototype;a.setView=function(a){this._view=a},a.view=function(){return this._view},a.parentView=function(){return this._view.parentView()},a.setBizDelegate=function(a){this._bizDelegate=a},a.bizDelegate=function(){return this._bizDelegate},a.model=function(){return this._model},a.apiAdapter=function(){return this._apiAdapter},a.getData=function(){return this._model.data},a.parentModel=function(){return this._parentController?this._parentController.model():null},a.getParentData=function(){return this._parentController?this._parentController.getData():null},a.setParentController=function(a){this._parentController=a},a.parentController=function(){return this._parentController},a.setNextController=function(a){this._nextController=a},a.addEmbeddedController=function(a){this._embeddedControllers.push(a)},a.removeEmbeddedController=function(a){this._embeddedControllers.splice(this._embeddedControllers.indexOf(a),1)},a.clear=function(){},a.createModel=function(){var a=this.viewSpec.modelSpec,b=this.viewSpec.apiSpec;debug.debug("BaseController.createModel() - creating new model for: "+this.viewSpec.name),this._model&&this._model.clear(),this._model=Trillo.modelFactory.createModel(a,this);var c=this.fetchDataLocally(a);if(!c){if(b)return this._apiAdapter=Trillo.apiAdapterFactory.createApiAdapter(b,this),this.loadData();if(!b&&Trillo.supportsTestData(this.viewSpec.type)&&(Trillo.isPreview||Trillo.useTestData))return this._apiAdapter=new Trillo.TestDataAdapter(b,this),this.loadData();c=this.fetchDefaultData(a)}this.dataAvailable(c);var d=$.Deferred();return d.resolve(this._model),d.promise()},a.loadData=function(a){var b=this,c=$.Deferred(),d=this._apiAdapter.loadData();return d.done(function(a,d,e){b.dataAvailable(a,d,e),c.resolve(b._model)}),d.fail(function(a){c.reject(a)}),c.promise()},a.shouldLoadNewData=function(){if(!this.model())return!0;if(this.apiAdapter())return this.apiAdapter().isApiSpecChanged(this.viewSpec.apiSpec);var a=this.getData(),b=this.fetchDataLocally(this.viewSpec.modelSpec)||this.fetchDefaultData(this.viewSpec.modelSpec);return a!==b},a.fetchDataLocally=function(a){if(a.data)return a.data;var b=this.getParentSelectedObj();if(b&&"-1"===Trillo.uidToId(b.uid)){var c=this.parentView().viewSpec.type;if(c===Trillo.ViewType.Tree||Trillo.isCollectionView(c))return b}var d=this.getParentSelectedObj()||this.getParentData(),e=null;if(d&&a.dataPath){if(e=Trillo.getObjectValue(d,a.dataPath))return e;if(e=this.fetchDefaultData(a))return Trillo.setObjectValue(d,a.dataPath,e),e}return null},a.fetchDefaultData=function(a){var b=this.viewSpec.type;if(Trillo.isCollectionView(b)||Trillo.isTreeView(b))return[];if(Trillo.isDetailView(b)||Trillo.isFormView(b))return{};var c=this.getParentSelectedObj()||this.getParentData();return c&&!a.dataPath&&this.viewSpec.embedded?c:{}},a.dataAvailable=function(a,b,c){var d=this.model();d&&(b?this.updatePaginatedData(a,c):(d.setDataQuiet(a),this.postProcessModel(this._model)))},a.updatePaginatedData=function(a,b){var c=this.model();!c.data||b?c.setDataQuiet(a.items):c.appendDataQuiet(a.items),a.items=null,c.setPaginationInfo(a),this.postProcessModel(this._model)},a.postProcessModel=function(a){},a.handleClickGeneric=function(a){if(a){var b=a.dataOrAttr("action-func");if(b&&this[b])return this[b](a,this.getSelectedObj(),this),!0}if(this._handleClickGeneric(a.dataOrAttr("nm"),a,this.getSelectedObj(),this))return!0;var c=a.dataOrAttr("nm");if(c&&"_home"!==c&&"_appHome"!==c){var d=a.attr("href");d&&"#"!==d||Trillo.alert.notYetImplemented(c)}return!1},a._handleClickGeneric=function(a,b,c,d){var e=!1;return this._bizDelegate&&this._bizDelegate.handleAction&&this._bizDelegate.handleAction(a,c,b,d)?!0:(this.handleAction(a,c,b,d)?e=!0:this.delegateActionToParent(a,c,b,d)&&(e=!0),e)},a.handleAction=function(a,b,c,d){},a.delegateActionToParent=function(a,b,c,d){return this.parentController()?this.parentController()._handleClickGeneric(a,c,b,d):!1},a.actionDone=function(a){},a.getSelectedObj=function(){return this._view?this._view.getSelectedObj():null},a.getParentSelectedObj=function(){var a=this.parentController();return a?a.getSelectedObj():null},a.getClosestSelectedObj=function(){var a=this.getSelectedObj();if(!a){var b=this.parentController();a=b?b.getClosestSelectedObj():null}return a},a.canSelectionChange=function(a){return!0},a.selectionChanging=function(a){},a.selectedObjChanged=function(a){},a.customizeViewSpec=function(a){return this.parentController()?this.parentController().customizeChildViewSpec(a):void 0},a.customizeChildViewSpec=function(a){},a.routeToSelectedView=function(a){this.updateRoute(a)},a.getSelected$Elem=function(){return this._view.getSelected$Elem()},a.getSelectedItem=function(){return this._view.getSelectedItem()},a.selectedItemChanged=function(a){},a.setParam=function(a,b){this.viewSpec.setParam(a,b),this.updateRoute()},a.getParam=function(a){return this.viewSpec.getParam(a)},a.getParams=function(){return this.viewSpec.getParams()},a.getRouteUpTo=function(a,b){if(!this.viewSpec.isAppView){var c=this.parentController(),d=c?c.getRouteUpTo(a):"",e=c?c.viewSpec.nextView:null;if(!this.viewSpec.embedded&&!this.viewSpec.autoLoad){var f=this.getMySubrouteAsStr(a);b&&f===e||(d=d+(f.length>0&&d.length>1?"/":"")+f)}return d}return Trillo.Config.pagePath},a.getInternalRoute=function(){return""},a.getMySubrouteAsStr=function(a){var b=this.viewSpec;if(!b)return"";var c=b.getMyPath()+this.getInternalRoute();if(0===c.length)return"";if(a){var d="";$.each(b.params,function(a,b){d+=(d.length?";":"")+(a+"="+b)}),c+=d.length?";"+d:""}return c},a.setRoute=function(a){Trillo.router.routeTo(a,!0)},a.selectAndRoute=function(a){},a.updateRoute=function(a){var b=this.getRouteUpTo(!0);a&&(b+=(b.length?"/":"")+a),Trillo.router.routeTo(b,!0)},a.getSelectionUidOrContextUid=function(){var a=this.getParam("sel");if(a&&Trillo.isUid(a)||(a=this.getParam("uid")),!a){var b=this.parentController();a=b?b.getSelectionUidOrContextUid():null}return a},a.getContextUid=function(){var a=this.getParam("uid");if(!a){var b=this.parentController();a=b?b.getSelectionUidOrContextUid():null}return a},a.customizeModelSpec=function(a){},a.showView=function(a){var b=$.Deferred();if(this.viewsInFlight[a.name])return b.reject(),b.promise();this.viewsInFlight[a.name]=a,a.params=a.params||{},a.embedded=!0;var c=this;return Trillo.builder.init(a,null,this._view).done(function(d){d.postSetup(),c.viewsInFlight[a.name]=null,b.resolve(d)}),b.promise()},a.showViewByName=function(a,b,c){var d={name:a,options:c};return b&&(d.modelSpec={data:b}),this.showView(d)},a.preViewShown=function(a){var b=this.parentController();b&&b.preViewShown(a)},a.postViewShown=function(a){var b=this.parentController();b&&b.postViewShown(a)},a.preViewCleanup=function(a){var b=this.parentController();b&&b.preViewCleanup(a)},a.postViewSetup=function(){},a.viewByName=function(a){var b=this.controllerByName(a);return b?b.view():null},a.controllerByName=function(a){var b=this.findControllerByNameNextDir(a);return b?b:this.findControllerByNamePrevDir(a)},a.findControllerByNameNextDir=function(a){if(this.name===a)return this;for(var b=0;b<this._embeddedControllers.length;b++){var c=this._embeddedControllers[b].findControllerByNameNextDir(a);if(c)return c}return this._nextController?this._nextController.findControllerByNameNextDir(a):void 0},a.findControllerByNamePrevDir=function(a){return this.name===a?this:this._parentController?this._parentController.findControllerByNamePrevDir(a):void 0},a.attrChanged=function(a,b,c,d,e){var f=this.parentController();f&&f.attrChanged(a,b,c,d,e)},a.objChanged=function(a){this._view.objChanged(a);var b=this.parentController();b&&b.objChanged(a)},a.objAdded=function(a,b){this._view.objAdded(a,b);var c=this.parentController();c&&c.objAdded(a,b)},a.objDeleted=function(a){this._view.objDeleted(a);var b=this.parentController();b&&b.objDeleted(a)},a.modelDataChanged=function(a){this._view.modelDataChanged(a);var b=this.parentController();b&&b.modelDataChanged(a)},a.refreshAllViews=function(a){},a.refreshViews=function(a){},a.updateTbState=function(a){this._bizDelegate&&this._bizDelegate.updateTbState&&this._bizDelegate.updateTbState(a)},a.setToolVisible=function(a,b){this._view.toolsMgr.setToolVisible(a,b)},a.setToolVisibleBySelector=function(a,b){this._view.toolsMgr.setToolVisibleBySelector(a,b)},a.postToolsActivate=function(){},a.showResult=function(a){"failed"===a.status?Trillo.alert.showError("Error",a.message||a.status):Trillo.alert.show("Success",a.message||a.status)},a.getAppRootElem=function(){return this._parentController?this._parentController.getAppRootElem():this._view.$elem()},a.showNamedMessagesAsError=function(a){},a.updateTitle=function(){},a.changeManagerUpdated=function(a,b){},a.undoing=function(a,b){},a.redoing=function(a,b){},a.undone=function(a,b){},a.redone=function(a,b){},a.undoCompleted=function(){},a.redoCompleted=function(){},a.txStarted=function(){},a.txEnding=function(){},a.txEnded=function(){},a.beforeShowContextMenu=function(){}}(),function(){"use strict";Trillo.Controller=Trillo.inherits(Trillo.BaseController,function(a){Trillo.BaseController.call(this,a)});var a=Trillo.Controller.prototype;a.$elem=function(){return this._view.$elem()},a.$container=function(){return this._view.$container()},a.refreshAllViews=function(){return Trillo.builder.refresh(this._view)},a.refreshViews=function(a){return Trillo.builder.refresh(this._view,a)},a.getInternalRoute=function(){return this._view.internalRoute.length?"/"+this._view.internalRoute:""},a.selectAndRoute=function(a){return this._view.selectAndRoute(a)},a.showNamedMessagesAsError=function(a){this._view.showNamedMessagesAsError(a)},a.updateTitle=function(){this._view.updateTitle()},a.handleAction=function(a,b,c,d){return"close"===a?(this.close(),!0):"ok"===a?(this.ok(),!0):"upload"===a?(this.doUpload(),!0):"hide"===a?(this._view.hide(),!0):"_home"===a||"_appHome"===a?(Trillo.navHistory.setDisabled(!0),!1):"actionTool"!=this.viewSpec.type&&"menu"!=this.viewSpec.type?this.doTriggerNextView(a,b):!1},a.actionDone=function(a){this.viewSpec.postRenderer&&this.viewSpec.postRenderer(a.selectedObj._trillo_infoBlock),this.getSelectedObj()===a.selectedObj&&this._view.setTbState()},a.close=function(){this.closing&&this.closing(this._view),this._view.clear()},a.closing=function(a){var b=this.parentController();b&&b.closing&&b.closing(a)},a.ok=function(){this.viewSpec.type===Trillo.ViewType.Form&&this.submitForm()},a.doTriggerNextView=function(a,b){b||(b={});var c=this.viewSpec.getNextViewSpecByTrigger(a);if(c){if("actionTool"===c.type)return!1;if("page"===c.type)return!1;if(c.dialog)return this.showViewByName(c.name,b),!0;var d;return c.absoluteRoute?(d=c.name+";uid="+b.uid,this.setRoute(d)):(d=c.name,this.updateRoute(d)),!0}var e=this.parentController();if(e&&Trillo.isCollectionView(this.viewSpec.type)&&e.viewSpec.type===Trillo.ViewType.Tree){var f=e.view().tree.getItemByUid(b.uid);if(f)return e.selectAndRoute(b.uid)}return!1},a.doUpload=function(){this.showView(this.getFileUploadSpec())},a.getFileUploadSpec=function(){return{name:"FileUpload",type:Trillo.ViewType.Default,dialog:!0,container:"trillo-dialog-container",controller:"Trillo.FileUploadC",modelSpec:{data:{fileName:"a"}},params:{targetViewName:this.viewSpec.name,folder:"",uploadUrl:"/fileUpload"}}},a.fileUploadSuccessful=function(a){this.viewSpec.dialog&&this.close()},a.fileUploadFailed=function(a){this.showFileUploadError(a.error)},a.showFileUploadError=function(a){this.$elem().find(".js-upload-alert").html(a).show()},a.clearFileUploadError=function(a){this.$elem().find(".js-upload-alert").html("").hide()},a.submitForm=function(){if(this._view.canSubmit()){var a=this.getData();if(!this.beforePost(a,this._view))return;var b,c,d=$.proxy(this.submitFormCompleted,this),e=this.viewSpec;b=a,c=e.postUrl,$.ajax({url:c,type:"post",data:Trillo.stringify(b),contentType:"application/json"}).done(d)}},a.getFormSubmitUrl=function(){return"/submitForm"},a.submitFormCompleted=function(a){"failed"===a.status?this.showNamedMessagesAsError(a.namedMessages):(this.clear(),this.viewSpec.dialog&&this.close()),this.afterPost(a,this.view())},a.beforePost=function(a,b){var c=this.parentController();return c?c.beforePost(a,b):!0},a.afterPost=function(a,b){var c=this.parentController();c?c.afterPost(a,b):("failed"!==a.status&&(b||this.view()).$e.find("form")[0].reset(),this.showResult(a))}}();
/*!
 * TrilloJS v0.5.0 (https://github.com/trillo/trillojs#readme)
 * Copyright 2017 Collager Inc.
 * Licensed under the MIT license
 */
!function(){"use strict";Trillo.FieldFactory=function(a){this.table={}};var a=Trillo.FieldFactory.prototype;a.registerFieldClass=function(a,b){this.table[a]=b},a._attachField=function(a,b,c){var d,e=a.data("_trillo_field_");if(!e){var f=a.dataOrAttr("field-type");d=f?this.table[f]:null,d||(d=this.getFieldClass(a,c)),e=new d(a,b,c),a.data("_trillo_field_",e)}return e},a.attachField=function(a,b){return this._attachField(a,b,!0)},a.attachReadonlyField=function(a,b){return this._attachField(a,b,!1)},a.attachFields=function(a,b){var c=this;$.each(a,function(){c.attachField($(this),b)})},a.attachReadonlyFields=function(a,b){var c=this;$.each(a,function(){c.attachReadonlyField($(this),b)})},a.getFieldClass=function(a,b){return a.is(":checkbox")?Trillo.CheckboxField:a.is(":radio")?Trillo.RadioField:a.is(":image")?Trillo.ImageField:a.is("select")?Trillo.SelectField:Trillo.canUserEnterData(a)?Trillo.InputField:Trillo.Field}}(),function(){"use strict";var a='<span class="js-field-message '+Trillo.CSS.fieldMsg+' text-info"></span>',b='<span class="js-field-error '+Trillo.CSS.fieldMsg+' text-danger"></span>';Trillo.Field=function(a,b,c){this.$e=a,this.view=b,this.editable=c,this.name=a.dataOrAttr("nm")};var c=Trillo.Field.prototype;c.validate=function(){var a=this.$e;if(!a.is(":visible"))return!0;this.clearInlineError();var b=!0,c=this.getValue(),d=""===c||void 0===c;return a.hasClass("js-required")&&d&&(this.inlineError("Required"),b=!1),!a.hasClass("number")||d||Trillo.isNumeric(c)||(this.inlineError("Numeric value required"),b=!1),b||a.parent().addClass(Trillo.CSS.hasErrorCss),b},c.inlineMsg=function(b){var c=this.$e,d=c.siblings(".js-field-message");return 0===d.length&&(c.after(a),d=c.siblings(".js-field-message")),d.html(b),d.parent().addClass(Trillo.CSS.hasMessageCss),d},c.inlineError=function(a){var c=this.$e,d=c.siblings(".js-field-error");return 0===d.length&&(c.after(b),d=c.siblings(".js-field-error")),d.html(a),d.parent().addClass(Trillo.CSS.hasErrorCss),d},c.clearInlineMessage=function(){var a=this.$e,b=a.siblings(".js-field-message");b.length&&(b.html(""),b.parent().removeClass(Trillo.CSS.hasMessageCss))},c.clearInlineError=function(){var a=this.$e,b=a.siblings(".js-field-error");b.length&&(b.html(""),b.parent().removeClass(Trillo.CSS.hasErrorCss))},c.getValue=function(){return this.$e.val()},c.setValue=function(a){var b=this.$e;a=Trillo.formatValue(b,a);var c=b.dataOrAttr("display-type");if("css-class"===c)if(a)b.addClass(a),b.attr("_value_as_css_class_",a);else{var d=b.attr("_value_as_css_class_");d&&(b.removeClass(a),b.removeAttr("_value_as_css_class_"))}else b.html("undefined"==typeof a?"":""+a)},c.setValueFromObj=function(a){var b=Trillo.getObjectValue(a,this.name);null===b&&(b=""),this.setValue(b)},c.setDisabled=function(a){var b=this.$e;a?b.attr("disabled",!0):b.removeAttr("disabled")}}(),function(){"use strict";Trillo.CheckboxField=Trillo.inherits(Trillo.Field,function(a,b,c){Trillo.Field.call(this,a,b,c),c||a.attr("disabled","true")});var a=Trillo.CheckboxField.prototype;Trillo.Field;a.setValue=function(a){this.$e.prop("checked",a)},a.getValue=function(){return this.$e.prop("checked")?!0:!1}}(),function(){"use strict";Trillo.RadioField=Trillo.inherits(Trillo.Field,function(a,b,c){Trillo.Field.call(this,a,b,c),c||a.attr("disabled","true")});var a=Trillo.RadioField.prototype;Trillo.Field;a.setValue=function(a){this.$e.prop("checked",a)},a.getValue=function(){return this.$e.prop("checked")?!0:!1}}(),function(){"use strict";Trillo.InputField=Trillo.inherits(Trillo.Field,function(a,b,c){Trillo.Field.call(this,a,b,c),c||a.attr("disabled","true")});var a=Trillo.InputField.prototype;Trillo.Field;a.setValue=function(a){var b=this.$e;Trillo.setSelectOptionsFromEnum(b,a),b.val(a),b.parent().find(".js-temp-elem-for-readonly").remove(),this.editable?b.show():(b.hide(),b.after('<span class="js-temp-elem-for-readonly">'+a+"</span>"))}}(),function(){"use strict";Trillo.SelectField=Trillo.inherits(Trillo.Field,function(a,b,c){Trillo.Field.call(this,a,b,c),c||a.attr("disabled","true")});var a=Trillo.SelectField.prototype;Trillo.Field;a.setValue=function(a){var b=this.$e;Trillo.setSelectOptionsFromEnum(b,a),b.val(a),b.parent().find(".js-temp-elem-for-readonly").remove(),this.editable?b.show():(b.hide(),a=b.find("option:selected").text(),b.after('<span class="js-temp-elem-for-readonly">'+a+"</span>"))}}(),function(){"use strict";Trillo.ImageField=Trillo.inherits(Trillo.Field,function(a,b,c){Trillo.Field.call(this,a,b,c),c||a.attr("disabled","true")});var a=Trillo.ImageField.prototype;Trillo.Field;a.setValue=function(a){this.$e.attr("src",a)}}(),function(){"use strict";Trillo.Controller=Trillo.inherits(Trillo.BaseController,function(a){Trillo.BaseController.call(this,a)});var a=Trillo.Controller.prototype;a.$elem=function(){return this._view.$elem()},a.$container=function(){return this._view.$container()},a.refreshAllViews=function(){return Trillo.builder.refresh(this._view)},a.refreshViews=function(a){return Trillo.builder.refresh(this._view,a)},a.getInternalRoute=function(){return this._view.internalRoute.length?"/"+this._view.internalRoute:""},a.selectAndRoute=function(a){return this._view.selectAndRoute(a)},a.showNamedMessagesAsError=function(a){this._view.showNamedMessagesAsError(a)},a.updateTitle=function(){this._view.updateTitle()},a.handleAction=function(a,b,c,d){return"close"===a?(this.close(),!0):"ok"===a?(this.ok(),!0):"upload"===a?(this.doUpload(),!0):"hide"===a?(this._view.hide(),!0):"_home"===a||"_appHome"===a?(Trillo.navHistory.setDisabled(!0),!1):"actionTool"!=this.viewSpec.type&&"menu"!=this.viewSpec.type?this.doTriggerNextView(a,b):!1},a.actionDone=function(a){this.viewSpec.postRenderer&&this.viewSpec.postRenderer(a.selectedObj._trillo_infoBlock),this.getSelectedObj()===a.selectedObj&&this._view.setTbState()},a.close=function(){this.closing&&this.closing(this._view),this._view.clear()},a.closing=function(a){var b=this.parentController();b&&b.closing&&b.closing(a)},a.ok=function(){this.viewSpec.type===Trillo.ViewType.Form&&this.submitForm()},a.doTriggerNextView=function(a,b){b||(b={});var c=this.viewSpec.getNextViewSpecByTrigger(a);if(c){if("actionTool"===c.type)return!1;if("page"===c.type)return!1;if(c.dialog)return this.showViewByName(c.name,b),!0;var d;return c.absoluteRoute?(d=c.name+";uid="+b.uid,this.setRoute(d)):(d=c.name,this.updateRoute(d)),!0}var e=this.parentController();if(e&&Trillo.isCollectionView(this.viewSpec.type)&&e.viewSpec.type===Trillo.ViewType.Tree){var f=e.view().tree.getItemByUid(b.uid);if(f)return e.selectAndRoute(b.uid)}return!1},a.doUpload=function(){this.showView(this.getFileUploadSpec())},a.getFileUploadSpec=function(){return{name:"FileUpload",type:Trillo.ViewType.Default,dialog:!0,container:"trillo-dialog-container",controller:"Trillo.FileUploadC",modelSpec:{data:{fileName:"a"}},params:{targetViewName:this.viewSpec.name,folder:"",uploadUrl:"/fileUpload"}}},a.fileUploadSuccessful=function(a){this.viewSpec.dialog&&this.close()},a.fileUploadFailed=function(a){this.showFileUploadError(a.error)},a.showFileUploadError=function(a){this.$elem().find(".js-upload-alert").html(a).show()},a.clearFileUploadError=function(a){this.$elem().find(".js-upload-alert").html("").hide()},a.submitForm=function(){if(this._view.canSubmit()){var a=this.getData();if(!this.beforePost(a,this._view))return;var b,c,d=$.proxy(this.submitFormCompleted,this),e=this.viewSpec;b=a,c=e.postUrl,$.ajax({url:c,type:"post",data:Trillo.stringify(b),contentType:"application/json"}).done(d)}},a.getFormSubmitUrl=function(){return"/submitForm"},a.submitFormCompleted=function(a){"failed"===a.status?this.showNamedMessagesAsError(a.namedMessages):(this.clear(),this.viewSpec.dialog&&this.close()),this.afterPost(a,this.view())},a.beforePost=function(a,b){var c=this.parentController();return c?c.beforePost(a,b):!0},a.afterPost=function(a,b){var c=this.parentController();c?c.afterPost(a,b):("failed"!==a.status&&(b||this.view()).$e.find("form")[0].reset(),this.showResult(a))}}(),function(){"use strict";Trillo.Tools=function(a){this.mgr=a.mgr,this.$toolsE=a.$toolsE,this.$toolsContainer=a.$toolsContainer,this.toolSelectedMethod=$.proxy(this.toolSelected,this),this.actionablToolElems=[],this.makeActionableToolElemsList(this.$toolsE,this.actionablToolElems)};var a=Trillo.Tools.prototype;a.activate=function(){this.$toolsContainer&&this.$toolsContainer.append(this.$toolsE),this.$toolsE.is(".js-app-managed-visibility")||this.$toolsE.removeClass("hide"),this.$toolsE.css("display",""),this.$toolsE.off("click",this.toolSelectedMethod),this.$toolsE.on("click",this.toolSelectedMethod)},a.clear=function(){this.$toolsE.off("click",this.toolSelectedMethod),this.$toolsE.addClass("hide"),this.$toolsContainer&&this.$toolsE.remove()},a.toolSelected=function(a){Trillo.hideCurrentOverlays(!0,!1);var b=Trillo.getActualTarget(a);if(b&&!b.hasClass("dropdown-toggle"))if(a&&a.stopPropagation(),b.closest("."+Trillo.CSS.buttonGroup+"."+Trillo.CSS.buttonGroupOpen).removeClass(Trillo.CSS.buttonGroupOpen),b.closest("."+Trillo.CSS.dropdown+"."+Trillo.CSS.dropdownOpen).removeClass(Trillo.CSS.dropdownOpen),this.mgr.handleClickGeneric(b))$(".js-navbar-toggle").each(function(){$($(this).data("target")).removeClass("in").addClass("collapse")}),a.preventDefault();else{var c=b.prop("tagName").toLowerCase();if("a"===c){var d=b.attr("href");d&&"#"!==d||a.preventDefault()}}},a.setDisabled=function(a){a?(this.$toolsE.find("button").attr("disabled",!0),this.$toolsE.find("a").attr("disabled",!0)):(this.$toolsE.find("button").removeAttr("disabled"),this.$toolsE.find("a").removeAttr("disabled"))},a.makeActionableToolElemsList=function(a,b){var c=this;$.each(a.children(),function(a,d){var e=$(d),f=e.prop("tagName").toLowerCase();e.hasClass("js-tool")||"a"===f||"button"===f?b.push(e):c.makeActionableToolElemsList(e,b)})},a.allHidden=function(){for(var a=this.actionablToolElems,b=0;b<a.length;b++)if(!a[b].hasClass("hide")&&"none"!==a[b].css("display"))return!1;return!0}}(),function(){"use strict";Trillo.ToolManager=function(a){this._view=a,this._controller=a.controller(),this.toolbarTools=null,this.hoverTools=null,this.contextTools=null,this.tools=[];var b=this,c=a.$elem();if("menu"!=a.viewSpec.type){if(a.$container()){var d=a.getToolBar$Elem();d.length>0&&(this.toolbarTools=this.makeTools(c.find(".js-toolbar-tools"),d,!0))}this.hoverTools=this.makeTools(c.find(".js-hover-tools"),null,!0),this.contextTools=this.makeTools(c.find(".js-context-menu"),null,!0),c.find(".js-tool").each(function(){b.makeTools($(this),null,!1)})}else c.find(".js-menu-item-trigger, .js-menu-item a, .js-menu-item button, .js-menu-item :input[type=button], .js-menu-item :input[type=submit], .js-menu-item :input[type=reset]").each(function(){b.makeTools($(this),null,!1)});c.find(".js-popover-trigger").each(function(){b.makePopover($(this))})};var a=Trillo.ToolManager.prototype;a.makeTools=function(a,b,c){if(Trillo.belongsToView(a,this._view.name)){a.data("for-view",this._view.name),c&&a.remove();var d=new Trillo.Tools({$toolsE:a,$toolsContainer:b,mgr:this});return this.tools.push(d),d}return null},a.makePopover=function(a){return Trillo.belongsToView(a,this._view.name)&&(a.data("for-view",this._view.name),Trillo.popoverManager.createPopoverForTrigger(a)),null},a.activate=function(){for(var a=this.tools,b=0;b<a.length;b++)a[b].activate();this.setTbState(null),this._controller.postToolsActivate()},a.clear=function(a){for(var b=this.tools,c=0;c<b.length;c++)b[c].clear()},a.handleClickGeneric=function(a){return this._controller.handleClickGeneric(a)?(Trillo.popoverManager.hideCurrentPopupIfContains(a),!0):!1},a.setTbState=function(a){var b,c=this.tools,d=a&&a.availabilityState===Trillo.OBJ_LOCKED;for(b=0;b<c.length;b++)Trillo.findAndSelf(c[b].$toolsE,"[data-for-class]").addClass("hide"),c[b].setDisabled(d);if(a){var e=Trillo.uidToClass(a.uid);if(e)for(b=0;b<c.length;b++)Trillo.findAndSelf(c[b].$toolsE,'[data-for-class="'+e+'"]').css("display","").removeClass("hide");for(b=0;b<c.length;b++)!c[b].$toolsE.is(":not([data-for-class])")||c[b].$toolsE.is(".js-context-menu")||c[b].$toolsE.is(".js-app-managed-visibility")||c[b].$toolsE.css("display","").removeClass("hide")}this._controller.updateTbState(a)},a.setPopoverTriggerState=function(a,b){var c,d,e=this.tools,f=this._view.$elem();if(!b)for(d=0;d<e.length&&!(b=!e[d].allHidden());d++);return f.find(".js-popover-trigger").each(function(){c=$(this),b?c.removeClass("trillo-trigger-has-no-content"):c.addClass("trillo-trigger-has-no-content")}),b},a.showContextMenu=function(a,b){return this.contextTools&&(this._controller.beforeShowContextMenu(this.contextTools.$toolsE),!this.contextTools.allHidden())?(Trillo.contextMenuManager.showContextMenu(this.contextTools.$toolsE,a,b),!0):!1},a.setToolVisible=function(a,b){var c='[nm="'+a+'"]';this.setToolVisibleBySelector(c,b)},a.setToolVisibleBySelector=function(a,b){var c,d=this.tools;if(b)for(c=0;c<d.length;c++)Trillo.findAndSelf(d[c].$toolsE,a).css("display","").removeClass("hide");else for(c=0;c<d.length;c++)Trillo.findAndSelf(d[c].$toolsE,a).addClass("hide")},a.removeToolsWithInElement=function(){for(var a=this.tools,b=[],c=0;c<a.length;c++)a[c].$toolsE.hasClass(".js-tool")?a[c].clear(this):b.push(a[c]);this.tools=b},a.addToolsWithInElement=function(a){var b=a.find(".js-tool");if(Trillo.belongsToView(b,this._view.name)){var c=new Trillo.Tools({$toolsE:b,mgr:this});return this.tools.push(c),c}return null},a.enableTool=function(a,b){var c='[nm="'+a+'"]';this.enableToolBySelector(c,b)},a.enableToolBySelector=function(a,b){var c,d=this.tools;if(b)for(c=0;c<d.length;c++)Trillo.findAndSelf(d[c].$toolsE,a).removeAttr("disabled");else for(c=0;c<d.length;c++)Trillo.findAndSelf(d[c].$toolsE,a).attr("disabled","disabled")}}(),function(){"use strict";Trillo.InfoElementRepo=function(){this.table={},this.tableOfList={}};var a=Trillo.InfoElementRepo.prototype;a.addTemplate=function(a,b){a.show(),this.table[b]=new Trillo.InfoElement(b,a,!0)},a.getE=function(a,b){var c=this.tableOfList[a];if(c&&c.length>0)return c.pop();var d=this.table[a];return d?d.copyIt(b):null},a.releaseE=function(a){if(!a.useTemplate){var b=this.tableOfList[a.elemKey];b||(this.tableOfList[a.elemKey]=b=[]),b.push(a),a.clear()}},a.makeInfoBlockList=function(a,b,c){var d=this.table[a];return d?d.requiresPositioning?this.makePositionedInfoBlockList(d,a,b,c):this.makeAutoInfoBlockList(d,a,b,c):null},a.makePositionedInfoBlockList=function(a,b,c,d){var e,f=[];a.$rootE.addClass(Trillo.CSS.positionOutside),d.canvasE.appendChild(a.e);var g,h,i,j,k,l,m,n,o=0,p="table"===d.parent.viewSpec.type,q=a.colWidths;for(p&&!q&&d.$headerRow&&(i=d.$headerRow,i.addClass(Trillo.CSS.positionOutside),d.$canvasE.append(i),j=d.$canvasE.width(),k=j,l=d.$headerRow.children(),l.length&&(l.each(function(){m=$(this),k-=m.width()}),q=[],k/=l.length,l.each(function(){m=$(this),n=Math.round((m.width()+k)/j*100),m.css("width",n+"%"),q.push(n)}),l=a.$rootE.children(),h=0,l.each(function(){h<q.length&&(m=$(this),m.css("width",q[h]+"%"),h++)})),i.removeClass(Trillo.CSS.positionOutside)),h=0;h<c.length;h++)c[h]._trillo_infoBlock||(e=new Trillo.InfoBlock(b,c[h],d),a.show(c[h],e),g=e.h=a.$rootE.outerHeight(),e.contentH=a.$rootE.height(),g>o&&(o=g),e.w=a.$rootE.outerWidth(),f.push(e),c[h]._trillo_infoBlock=e,a.clear());if(d.areAllSameSize)for(h=0;h<f.length;h++)f[h].contentH+=o-f[h].h,f[h].h=o;return a.$rootE.removeClass(Trillo.CSS.positionOutside),a.clear(),d.canvasE.removeChild(a.e),f},a.makeAutoInfoBlockList=function(a,b,c,d){for(var e,f=[],g=0;g<c.length;g++)c[g]._trillo_infoBlock||(e=new Trillo.InfoBlock(b,c[g],d),f.push(e),c[g]._trillo_infoBlock=e);return f},a.requiresLayout=function(a){var b=this.table[a];return b&&b.requiresPositioning},Trillo.InfoElement=function(a,b,c){if(this.$rootE=b,this.elemKey=a,this.e=b[0],this.elements=[],this.hasTemplateTokens=!1,this.requiresPositioning=!0,c){var d=b[0].outerHTML;if(d.indexOf("{{")>=0){debug.debug("Trillo.InfoElement - parsing using Mustache");var e=Mustache.parse(d);e.length>1?(debug.debug("Trillo.InfoElement - requires template processing while doing copyIt"),this.templateHtml=d,this.useTemplate=!0):debug.debug("Trillo.InfoElement - no template processing needed")}else debug.debug("Trillo.InfoElement - no template parsing done");b.hide(),document.body.appendChild(b[0]);var f=b.css("position");document.body.removeChild(b[0]),b.show(),this.requiresPositioning=f&&"absolute"===f.toLowerCase()}for(var g,h=this.e.getElementsByTagName("*"),i=0;i<h.length;i++)g=h[i],!Trillo.isActionElement($(g))&&g.getAttribute("nm")&&this.elements.push(g);this.$inputs=Trillo.getInputs(b)};var b=Trillo.InfoElement.prototype;b.show=function(a,b){for(var c,d,e,f,g=this.elements,h=g.length,i=0;h>i;i++)c=$(g[i]),f=Trillo.getCreateField(c),f.setValue(a[f.name]);var j=b.contentH;this.$rootE.hasClass("js-content-row")&&j&&(this.$rootE.height(j),this.$rootE.children().each(function(){d=$(this),d.height(j),e=d.children(),0===e.length?d.css("line-height",j+"px"):1===e.length&&e.css("margin-top",(j-e.outerHeight())/2+"px")}))},b.clear=function(){for(var a,b=this.elements,c=b.length,d=0;c>d;d++)a=Trillo.getCreateField($(b[d])),a.setValue(null)},b.copyIt=function(a){var b;if(this.useTemplate){var c=Mustache.render(this.templateHtml,a);b=$("<div/>").html(c).contents()}else b=this.$rootE.clone();var d=new Trillo.InfoElement(this.elemKey,b,!1);return d.useTemplate=this.useTemplate,d.requiresPositioning=this.requiresPositioning,d},Trillo.InfoBlock=function(a,b,c){this.elemKey=a,this.obj=b,this.canvas=c,this.x=0,this.y=0,this.h=-1,this.w=-1,this.infoE=null,this.clickHandler=$.proxy(this.clicked,this),this.dblClickHandler=$.proxy(this.dblClicked,this),this.contextMenuHandler=$.proxy(this.onContextMenu,this),c.supportsHoverTools&&(this.mouseOverHandler=$.proxy(this.mouseOver,this),this.mouseLeaveHandler=$.proxy(this.mouseLeave,this)),this.changeHandler=$.proxy(this.fieldChanged,this)};var c=Trillo.InfoBlock.prototype;c.show=function(){var a=this.infoE;a?this.canvas.canvasE.appendChild(a.e):(this.infoE=a=Trillo.infoElementRepo.getE(this.elemKey,this.obj),a.requiresPositioning,this.canvas.canvasE.appendChild(a.e),a.show(this.obj,this)),a.requiresPositioning&&a.$rootE.css({left:this.x,top:this.y}),a.$rootE.off("click",this.clickHandler),a.$rootE.on("click",this.clickHandler),a.$rootE.off("dblclick",this.dblClickHandler),a.$rootE.on("dblclick",this.dblClickHandler),a.$rootE.off("contextmenu",this.contextMenuHandler),a.$rootE.on("contextmenu",this.contextMenuHandler),this.mouseOverHandler&&(a.$rootE.off("mouseover",this.mouseOverHandler),a.$rootE.on("mouseover",this.mouseOverHandler)),a.$inputs.length>0&&(a.$inputs.off("change",this.changeHandler),a.$inputs.on("change",this.changeHandler)),this.canvas.postRenderer&&this.canvas.postRenderer(this)},c.refresh=function(){this.infoE&&(this.infoE.show(this.obj,this),this.canvas.postRenderer&&this.canvas.postRenderer(this))},c.hide=function(){var a=this.infoE;a&&(a.$rootE.off("click",this.clickHandler),a.$rootE.off("dblclick",this.dblClickHandler),a.$rootE.off("contextmenu",this.contextMenuHandler),this.mouseOverHandler&&(a.$rootE.off("mouseover",this.mouseOverHandler),a.$rootE.off("mouseleave",this.mouseLeaveHandler)),Trillo.infoElementRepo.releaseE(a),this.canvas.selected===this&&this.canvas.unselectInfoItem(this),a.$inputs.length>0&&a.$inputs.off("change",this.changeHandler),this.infoE=null)},c.setPosition=function(a,b){this.x=a,this.y=b},c.move=function(a,b){this.x+=a,this.y+=b},c.clicked=function(a){Trillo.hideCurrentOverlays(!0,!1);var b=!1;if(a&&!$(a.target).is(":input")){a.stopPropagation();var c=$(a.target);if("a"==c.prop("tagName").toLowerCase()){var d=c.attr("href");d&&"#"!==d||(b=!0)}}(this.canvas.clicked(this,a)||b)&&a.preventDefault()},c.dblClicked=function(a){Trillo.hideCurrentOverlays(!0,!1),a&&!$(a.target).is(":input")&&a.stopPropagation(),this.canvas.dblClicked(this,a)},c.onContextMenu=function(a){a.stopPropagation(),this.canvas.doContextMenu(this,a.pageX,a.pageY)&&a.preventDefault()},c.select=function(){this.infoE&&this.infoE.$rootE.addClass(Trillo.CSS.selected)},c.unselect=function(){this.infoE&&this.infoE.$rootE.removeClass(Trillo.CSS.selected)},c.mouseOver=function(a){var b=this.infoE;return b.$rootE.off("mouseover",this.mouseOverHandler),b.$rootE.on("mouseleave",this.mouseLeaveHandler),this.canvas.setHoverInfoItem(this),!0},c.mouseLeave=function(a,b){var c=this.infoE;c.$rootE.on("mouseover",this.mouseOverHandler),c.$rootE.off("mouseleave",this.mouseLeaveHandler),this.canvas.setHoverInfoItem(null)},c.fieldChanged=function(a){var b=$(a.target),c=Trillo.getCreateField(b),d=c.getValue();this.canvas.changeAttr(this.obj,c.name,d)},Trillo.infoElementRepo=new Trillo.InfoElementRepo}(),function(){"use strict";Trillo.Canvas=function(a,b){if(this.areAllSameSize=!0,this.parent=a,this.$c=a.$container(),this.$canvasE=a.$e.hasClass("js-grid")?a.$e:a.$e.find(".js-grid"),this.canvasE=this.$canvasE[0],this.virtual=b.virtual,this.elemKey=b.elemKey,this.isListViewMode=b.isListViewMode,this.$headerRow=b.$headerRow,this.dialog=b.dialog,this.postRenderer=b.postRenderer,this.loadingData=!0,this.scrollListener=$.proxy(this.doScrolling,this,!1),this.actualScrollHandler=$.proxy(this._doScrolling,this),this.showListHandler=$.proxy(this.doShowList,this),this.scrollTimer=null,this.actualScrollTimer=null,this.showTimer=null,this.isScrollListenerAdded=!1,this.nonNativeSB=a.$_sb,Trillo.isTouchSurface&&!this.nonNativeSB&&document.addEventListener("touchstart",$.proxy(this.scrollListener,this)),this.$pagination=$(".js-pagination"),this.selected=null,this.supportsHoverTools=!1,b.canvasToolsSelector){var c=$(b.canvasToolsSelector);c.length>0&&(this.canvasTools=new Trillo.Tools({$toolsE:c,mgr:this}),this.canvasTools.actionHandler=this,this.supportsHoverTools=!0)}var d=this.$canvasE;this.sortM=$.proxy(this.doSort,this);var e=d.attr("row-gap");this.rowGap=e?parseInt(e,10):Trillo.Options.V_MARGIN,e=d.attr("top-row-gap"),this.topRowGap=e?parseInt(e,10):Trillo.Options.V_MARGIN_TOP_ROW,e=d.attr("col-gap"),this.colGap=e?parseInt(e,10):Trillo.Options.H_MARGIN,e=d.attr("max-cols"),this.maxCols=e?parseInt(e,10):-1,e=d.attr("h-align"),this.hAlign=e||"auto",e=d.attr("auto-select"),this.autoSelect=e&&"true"===e.toLowerCase()};var a=Trillo.Canvas.prototype;a.windowResized=function(){this.layout(),this.showChildren(),this.updatePagination()},a.clear=function(){this.$canvasE.empty(),this.$headerRow&&this.$headerRow.find("[sortable]").off("click",this.sortM),this.page&&this.page.items&&$.each(this.page.items,function(){this._trillo_infoBlock=void 0}),this.page=null,this.infoBlocks=null,this.clearShowTimer(),this.clearScrollTimer(),this.clearActualScrollTimer(),this.$pagination.hide(),this.removeScrollListener(),this.setScrollBarPos(0)},a.setScrollBarPos=function(a){this.nonNativeSB?this.parent.setScrollBarPos(0):$(window).scrollTop(0)},a.getScrollBarPos=function(){return this.nonNativeSB?this.parent.getScrollBarPos():$(document).scrollTop()},a.objAdded=function(a,b){var c=Trillo.infoElementRepo.makeInfoBlockList(this.elemKey,[a],this);if(this.infoBlocks)if(b)this.infoBlocks=this.infoBlocks.concat(c);else for(var d=c.length-1;d>=0;d--)this.infoBlocks.unshift(c[d]);else this.infoBlocks=c;this.refresh(),b&&this.setScrollBarPos(this.contentH)},a.objChanged=function(a){a._trillo_infoBlock&&a._trillo_infoBlock.refresh()},a.setContent=function(a){this.addScrollListener(),this.loadingData=!1;var b=Trillo.infoElementRepo.makeInfoBlockList(this.elemKey,a.items,this);this.infoBlocks?this.infoBlocks=this.infoBlocks.concat(b):this.infoBlocks=b||[],this.page=a,this.refresh()},a.refresh=function(a){this.$canvasE.empty(),this.showHeader(),this.layout(),this.showChildren(),this.updatePagination(),this.parent.updateScrollBar()},a.showHeader=function(){var a=this.$headerRow;return a&&a.length>0?(this.canvasE.appendChild(a[0]),a.find("[sortable]").off("click",this.sortM),a.find("[sortable]").on("click",this.sortM),a.outerHeight()):0},a.layout=function(){Trillo.infoElementRepo.requiresLayout(this.elemKey)&&this._layout()},a._layout=function(){var a,b,c,d,e,f=this.infoBlocks,g=f.length,h=0,i=0;this.$headerRow&&this.$headerRow.css("top",this.$canvasE.offset().top),this.isListViewMode?(e=1,d=$(this.$canvasE).width()):(d=(g>0?f[0].w:0)+this.colGap,e=Math.floor(($(this.$canvasE).width()-this.colGap)/d),0>=e&&(e=1),this.maxCols>0&&e>this.maxCols&&(e=this.maxCols),1===e&&(d-=this.colGap));var j=this.showHeader();0===j&&(j=this.isListViewMode?0:this.topRowGap);var k,l=[];for(k=0;e>k;k++)l[k]=j;var m,n=0,o=null,p=null;for(k=0;g>k;k++){p=o,o=f[k],n=0,m=l[0];for(var q=1;q<l.length;q++)l[q]<m&&(0===l[q]||m-l[q]>50)&&(m=l[q],n=q);c=l[n],b=d*n,o.setPosition(b,c),a=b+d,a>h&&(h=a),a=c+o.h+(this.isListViewMode?0:this.rowGap),l[n]=a,a>i&&(i=a)}0===i&&(i=j),this.contentW=this.$canvasE.outerWidth(),this.contentH=i+(this.page.pageNumber<this.page.numberOfPages?Trillo.Options.BOTTOM_SPACE_FOR_INF_SCROLL:0),this.$canvasE.css({height:this.contentH});var r=this.hAlign;if(!this.isListViewMode&&"left"!==this.hAlign){var s=Math.floor((this.contentW-h)/2);if("auto"===r&&s>h/4?s=0:"right"==r&&(s=2*s),s>0)for(k=0;g>k;k++)o=f[k],o.move(s,0)}!this.dialog&&this.$headerRow&&this.$headerRow.css({width:this.contentW}),this.updateContainerGeom()},a.showChildren=function(){this.virtual&&Trillo.infoElementRepo.requiresLayout(this.elemKey)?this.showSomeChildren():this.showAllChildren()},a.showSomeChildren=function(){if(!this.loadingData){this.clearShowTimer(),this.showList=[];var a,b,c,d,e,f=$(window).height()-this.$canvasE.offset().top;a=c=this.getScrollBarPos(),b=d=a+f,a-=5*f,0>a&&(a=0),b+=5*f,b>a+this.contentH&&(b=a+this.contentH);var g,h=this.infoBlocks,i=h.length;for(g=0;i>g;g++){var j=h[g];if(j.y>b)j.hide(!0);else{var k=j.y+j.h;a>=k?j.hide(!0):(e=k>=c&&j.y<=d,e?j.show():j.shown||this.showList.push(j))}}$(".js-load-indicator-top").hide(),$(".js-load-indicator-bottom").hide(),d>=this.contentH&&(this.loadingData=this.loadNextPage(),this.loadingData?$(".js-load-indicator-bottom").show():this.noMoreItems=!0),this.showList.length>0&&(this.showTimer=setTimeout(this.showListHandler,200))}},a.showAllChildren=function(){if(!this.loadingData){this.clearShowTimer();for(var a=this.infoBlocks,b=a.length,c=0;b>c;c++){var d=a[c];d.show()}}},a.doShowList=function(){for(var a=this.showList,b=a.length,c=0;b>c;c++)a[c].show()},a.clearShowTimer=function(){this.showTimer&&(clearTimeout(this.showTimer),this.showTimer=null)},a.loadNextPage=function(){return this.page.pageNumber<this.page.numberOfPages?(this.parent.loadPage(this.page.pageNumber+1),!0):!1},a.addScrollListener=function(){this.virtual&&(this.isScrollListenerAdded||(this.isScrollListenerAdded=!0,this.nonNativeSB?this.parent.$_sb.bind("scroll",this.scrollListener):$(window).bind("scroll",this.scrollListener)))},a.removeScrollListener=function(){this.isScrollListenerAdded&&(this.isScrollListenerAdded=!1,this.nonNativeSB?this.parent.$_sb.unbind("scroll",this.scrollListener):$(window).unbind("scroll",this.scrollListener))},a.doScrolling=function(a){if(this.clearScrollTimer(),this.updatePagination(),this.loadingData)return void(this.scrollTimer=setTimeout(this.scrollListener,200));this.clearActualScrollTimer(),this.clearShowTimer();var b=this.getScrollBarPos(),c=b+$(window).height()-this.$canvasE.offset().top;(Trillo.isTouchSurface||this.nonNativeSB)&&c<this.contentH?this.actualScrollTimer=setTimeout(this.actualScrollHandler,100):this._doScrolling()},a.updatePagination=function(){if(this.virtual){for(var a,b,c=this.getScrollBarPos(),d=c+$(window).height()-this.$canvasE.offset().top,e=this.infoBlocks,f=e.length,g=-1,h=-1,i=0,j=0;f>j;j++)a=e[j],i++,b=a.y+a.h,b>=c&&a.y<=d-20&&(-1===g&&(g=i),h=i);this.$pagination.show(),this.$pagination.html(g+"-"+h)}else this.$pagination.hide()},a._doScrolling=function(){this.showChildren()},a.clearScrollTimer=function(){this.scrollTimer&&(clearTimeout(this.scrollTimer),this.scrollTimer=null)},a.clearActualScrollTimer=function(){this.actualScrollTimer&&(clearTimeout(this.actualScrollTimer),this.actualScrollTimer=null)},a.clicked=function(a,b){this.parent.hideOverlaidContainer();var c=$(b.target);return Trillo.isActionElement(c)?(this.selected!==a&&this.selectInfoItem(a),this.parent.controller().handleClickGeneric(c)):(this.selectInfoItem(a),this.parent.clicked(a,b)?!0:!1)},a.dblClicked=function(a,b){this.parent.hideOverlaidContainer();var c=$(b.target);return Trillo.isActionElement(c)?(this.selected!==a&&this.selectInfoItem(a),this.parent.controller().handleClickGeneric(c)):this.parent.infoItemDblClicked(a,b)?!0:(this.selectInfoItem(a),!1)},a.doContextMenu=function(a,b,c){return this.selected!==a&&this.selectInfoItem(a),this.parent.showContextMenu(b,c)},a.handleClickGeneric=function(a){if(this.hoverInfoItem){var b=this.hoverInfoItem;this.selected!==b&&(this.selected&&this.selected.unselect(),this.selected=b,b.select(),this.parent.selectInfoItem(b)),this.parent.controller().handleClickGeneric(a)}},a.setHoverInfoItem=function(a){if(this.hoverInfoItem=a,a){if(a.obj.availabilityState===Trillo.OBJ_LOCKED)return;a.infoE.$rootE.append(this.canvasTools.$toolsE),this.canvasTools.activate()}else this.canvasTools.clear()},a.selectInfoItem=function(a){if(this.parent.canSelectionChange(a.obj)){if(this.parent.selectionChanging(a.obj),this.selected===a)return void this.unselectInfoItem(a);this.selected&&this.selected.unselect(),this.selected=a,a.select(),this.parent.selectInfoItem(a)}},a.unselectInfoItem=function(a){this.selected===a&&(this.parent.unselectInfoItem(a),a.unselect(),this.selected=null)},a.selectItemByUid=function(a){if(!a)return null;var b=this.parent.model().getObj(a);if(b&&b._trillo_infoBlock){var c=b._trillo_infoBlock;return c!==this.selected&&this.selectInfoItem(c),c}return null},a.updateContainerGeom=function(){var a=this.$canvasE.parent().css("position");"absolute"===a&&this.$canvasE.parent().height(this.$canvasE.outerHeight())},a.doSort=function(a){a.stopPropagation(),a.preventDefault(),this.parent.doSort(a)},a.changeAttr=function(a,b,c){this.parent.changeAttr(a,b,c)}}(),function(){"use strict";Trillo.Tree=function(a){this.DEFAULT_NODE_TEMPLATE='<div class="tree-node js-tree-node"><div class="trillo-tree-item js-tree-node-inner"><span nm="name"></span></div></div>',this.name="TrilloTree",this.parent=a.parent,this.alwaysOpen=a.alwaysOpen,this.scrollPolicy=a.scrollPolicy||Trillo.Options.NO_SCROLL,this.openOnFirstClick=a.openOnFirstClick,this.closeOthers=a.closeOthers,this.toc=a.toc,this.timer=null,this.$e=a.$e,this.$treeE=this.$e.find(".js-tree"),this.$treeNodes=[],this.prepareNodeTemplates(this.$treeE,0),this._lookupTable={},this.clickHandler=$.proxy(this.linkClicked,this),this.contextMenuHandler=$.proxy(this.onContextMenu,this),this.scrollPolicy===Trillo.Options.SCROLL_ON_HOVER&&(this.mouseOverHandler=$.proxy(this.onMouseOver,this),this.mouseOutHandler=$.proxy(this.onMouseOut,this),this.delayedOnMouseOut=$.proxy(this._onMouseOut,this))};var a=Trillo.Tree.prototype;a.clear=function(){this.setTreeData([]),this.clearTimeout(),this.removeEventHandlers()},a.prepareNodeTemplates=function(a){var b=a.find(".js-tree-node");if(0===b.length){if(0!==this.$treeNodes.length)return;b=$(this.DEFAULT_NODE_TEMPLATE)}else b=$(b[0]),b.remove();this.$treeNodes.push(b),this.prepareNodeTemplates(b)},a.newNode=function(a){var b=a>=this.$treeNodes.length?this.$treeNodes.length-1:a;return this.$treeNodes[b].clone(!0)},a.removeEventHandlers=function(){var a=this.$e;a.off("click",this.clickHandler),a.off("contextmenu",this.contextMenuHandler),this.mouseOverHandler&&(a.off("mouseover",this.mouseOverHandler),a.off("mouseout",this.mouseOutHandler))},a.addHandlers=function(){var a=this.$e;this.removeEventHandlers(),this.scrollPolicy===Trillo.Options.SCROLL_ON_HOVER&&(a.on("mouseover",this.mouseOverHandler),a.on("mouseout",this.mouseOutHandler)),a.on("click",this.clickHandler),a.on("contextmenu",this.contextMenuHandler)},a.getSelectedItem=function(){return this.getObj(this._selectedItem);
},a.getSelectedItemUid=function(){return this._selectedItem?this._selectedItem.uid:null},a.setTreeData=function(a,b){this.addHandlers(),this._lookupTable={},a=this.traverseTree(a),this.unselectCurrent(),this._list=a,this._selectedItem=null,this.resetElements(a),this.$treeE.empty(),this.renderList(null,a,this.$treeE),this.alwaysOpen||b===Trillo.Options.OPEN_ALL?this.openAll():b===Trillo.Options.CLOSE_ALL&&this.closeAll()},a.renderList=function(a,b,c,d){for(var e=0;e<b.length;e++){var f=b[e],g=f._es_;g?(g.e.data("uid",f.uid),g.e.data("nm",f.uid),"undefined"!=typeof f.hideNode&&f.hideNode&&g.e.hide()):f._es_=g=this.renderElement(f),c.append(g.e)}this.parent.updateScrollBar()},a.renderElement=function(a){var b=a._lvl_,c=this.newNode(b),d=c.find(".js-lvl-"+b);d.length&&(c=d),c.addClass(Trillo.CSS.treeNodeLevelPrefix+b),c.data("uid",a.uid),c.data("nm",a.uid);var e=c.find(".js-tree-node-inner");return this.canExpand(a)&&e.addClass(Trillo.CSS.itemClose),this.setFieldsValues(e,a),a.hideNode&&c.hide(),{e:c,e2:e,lvl:b}},a.setFieldsValues=function(a,b){for(var c,d,e=a.find("[nm]"),f=e.length,g=0;f>g;g++)c=$(e[g]),d=Trillo.getCreateField(c),d.setValue(b[c.dataOrAttr("nm")])},a.refresh=function(){this._refresh(this._list),this.parent.updateScrollBar()},a._refresh=function(a){if(a)for(var b=0;b<a.length;b++){var c=a[b],d=c._es_;d&&(this.setFieldsValues(d.e2,c),this._refresh(c.children))}},a.resetElements=function(a){for(var b,c=0;c<a.length;c++)b=a[c],b._es_=null,b.children&&this.resetElements(b.children)},a.linkClicked=function(a,b){var c=$(a.target).closest("."+Trillo.CSS.treeNode).dataOrAttr("uid");if(c){b||Trillo.hideCurrentOverlays(!0,!1),this.parent.hideOverlaidContainer();var d=this._lookupTable[c];if(b){if(d===this._selectedItem)return}else a.stopPropagation();if(d._isAction&&!b)return void this.parent.handleClickGeneric(d._es_.e,this.getObj(d));if(!this.parent.canSelectionChange(this.getObj(d)))return;this.parent.selectionChanging(this.getObj(d));var e=d._es_,f=!0;if(!this.alwaysOpen&&this.canExpand(d)){var g=d===this._selectedItem||e.e2[0]===a.target,h=this.openOnFirstClick||g;e.open?g&&(this.closeItem(d),f=!1):h&&this.openItem(d)}d!==this._selectedItem&&this.selectItem(d,f,!b),this.parent.treeItemSelected(this.getObj(d))}},a.onContextMenu=function(a){a.stopPropagation();var b=$(a.target).closest("."+Trillo.CSS.treeNode).dataOrAttr("uid");if(b){var c=this._lookupTable[b],d=c._es_,e=d.e.offset();this.linkClicked(a,!0);var f=d.e.offset();this.parent.showContextMenu(a.pageX+f.left-e.left,a.pageY+f.top-e.top)?a.preventDefault():Trillo.hideCurrentOverlays(!0,!0)}},a.openItem=function(a){if(this.canExpand(a,this)){var b=a._es_;b&&b.open||(b||(a._es_=b=this.renderElement(a)),b.open=!0,this.renderList(a,a.children,b.e,b.e2),b.e2.removeClass(Trillo.CSS.itemClose).addClass(Trillo.CSS.itemOpen))}},a.closeItem=function(a){var b=a._es_;b&&(b.open=!1,b.e.find(".js-tree-node").remove(),this.canExpand(a,this)&&b.e2.removeClass(Trillo.CSS.itemOpen).addClass(Trillo.CSS.itemClose),b.e.append(b.e2))},a.openItem2=function(a){for(var b=[],c=a;c&&"undefined"!=typeof c._lvl_;)b.push(c),c=c.parent;for(var d=b.length-1;d>=0;d--){c=b[d];var e=c._es_;e||(c._es_=e=this.renderElement(c)),this.openItem(c)}},a.selectItem=function(a,b,c){if(a!==this._selectedItem){var d,e=this.unselectCurrent();if(a&&(b&&this.openItem2(a),this._selectedItem=a,d=a._es_,d.e2.addClass(Trillo.CSS.selected),c&&this.scrollSelectedInView()),this.closeOthers&&c&&e){var f=this.getCloseableParent(e),g=a?this.getCloseableParent(a):{};f!==g&&f!==g.parent&&(this.closeItem(f),a&&this.scrollSelectedInView(!0))}}},a.unselectCurrent=function(){var a,b=this._selectedItem;return b&&(a=b._es_,a.e2.removeClass(Trillo.CSS.selected),this._selectedItem=null),b},a.selectItemByUid=function(a){if(!a||0===this._list.length)return!1;var b=this._lookupTable[a];return this.selectItem(b,!0,!0),b},a.getItemByUid=function(a){return this._lookupTable[a]},a.scrollSelectedInView=function(a){setTimeout($.proxy(this._scrollSelectedInView,this,a),100)},a._scrollSelectedInView=function(a){if(this._selectedItem&&(a||this.scrollPolicy!==Trillo.Options.NO_SCROLL)){var b,c,d,e,f,g,h,i=this._selectedItem._es_,j=i.e,k=this.$e,l=k.offset().top;if(d=j.offset().top,this.scrollPolicy===Trillo.Options.SCROLL_ON_HOVER||this.scrollPolicy===Trillo.Options.AUTO_SCROLL||this.scrollPolicy===Trillo.Options.NON_NATIVE_SCROLLBAR)if(f=k.outerHeight(),b=k.scrollTop(),c=b+f,g=d-l+b,h=g+j.outerHeight(),this.scrollPolicy===Trillo.Options.NON_NATIVE_SCROLLBAR)b=g-parseInt((f-i.e2.outerHeight())/2,10),this.parent.setScrollBarPos(b);else{if(g>b&&c>h)return;e=k.css("overflow"),k.css("overflow","auto"),b=g-parseInt((f-i.e2.outerHeight())/2,10),k.scrollTop(b),"auto"!==e&&k.css("overflow","hidden")}else if(this.scrollPolicy===Trillo.Options.SMOOTH_SCROLL){b=document.viewport.getScrollOffsets().top,f=$(window).height()-l,c=b+f,g=d-l,h=g+j.outerHeight();var m=this.getTopParent(this._selectedItem);if(m!==this._selectedItem&&g>b&&c>h)return;var n=m._es_.e,o=n.offset().top;if(b=d-o+i.e2.outerHeight()<f?o-l-b+parseInt(i.e.css("padding-top"),10):g-parseInt((f-i.e2.outerHeight())/2,10)-b,0===b)return;var p=0>b?1:2;b=Math.abs(b),this.smoothVScroll(b,p)}}},a.openAll=function(){this._openAll(this._list),this.parent.updateScrollBar()},a._openAll=function(a){for(var b,c=0;c<a.length;c++)b=a[c],b.children.length&&(this.closeItem(a[c]),this.openItem(a[c]),this._openAll(b.children))},a.closeAll=function(){this._closeAll(this._list),this.parent.updateScrollBar()},a._closeAll=function(a){for(var b,c=0;c<a.length;c++)b=a[c],b.children.length&&(this.closeItem(a[c]),this._closeAll(b.children))},a.clearTimeout=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},a.onMouseOver=function(){this.clearTimeout(),this.$e.css("overflow","auto")},a.onMouseOut=function(){this.clearTimeout(),this.timer=setTimeout(this.delayedOnMouseOut,1e3)},a._onMouseOut=function(){this.clearTimeout(),this.$e.css("overflow","hidden")},a.getTopParent=function(a){if(!a)return null;for(;a.parent&&"undefined"!=typeof a.parent._lvl_;)a=a.parent;return a},a.getCloseableParent=function(a){for(;a.parent&&!a.parent.closeOthers;)a=a.parent;return a},a.canExpand=function(a){return a?a.children&&a.children.length>0:!0},a.smoothVScroll=function(a,b){function c(){d=f>a?a:f,window.scrollBy(0,1===b?-d:d),a-=f,a>0&&setTimeout(c,g)}var d,e=100,f=10,g=30;a>e?(d=a-e,window.scrollBy(0,1===b?-d:d),a=e,setTimeout(c,g)):c()},a.traverseTree=function(a){for(var b,c,d=[],e=this._traverseTree(a,null,0,d),f=null,g=this._lookupTable,h=0,i=d.length;i>h;h++)b=d[h],b._prev_=f,f&&(f._next_=b),f=b,c=Trillo.uid(b),c&&(g[c]=b);return e},a._traverseTree=function(a,b,c,d){return Trillo.isObject(a)?this._traverseObj(a,b,c,d):Trillo.isArray(a)?this._traverseArray(a,b,c,d):a},a._traverseObj=function(a,b,c,d){a=$.extend({},a),a.parent=b,a._lvl_=c,d.push(a);for(var e in a)"parent"!=e&&a.hasOwnProperty(e)&&(a[e]=this._traverseTree(a[e],a,c+1,d));return a},a._traverseArray=function(a,b,c,d){var e,f=a.length,g=[];for(e=0;f>e;e++)g.push(this._traverseTree(a[e],b,c,d));return g},a.getObj=function(a){return this.parent.model().getObj(a.uid)}}(),function(){"use strict";Trillo.TitleBar=function(a){this.titleBar=a.titleBar,this.ownerView=a.ownerView,this.$titleBarE=$(a.titleBar)};var a=Trillo.TitleBar.prototype;a.setTitle=function(a,b,c){if(0!==this.$titleBarE.length){if(b=b||"",c=c||"",0===b.length)return void this.clearTitle(a);Trillo.HtmlTemplates.titleBarTitlePrefix&&!Trillo.HtmlTemplates.titleBarTemplates__parsed__&&(Mustache.parse(Trillo.HtmlTemplates.titleBarTitlePrefix),Mustache.parse(Trillo.HtmlTemplates.titleBarTitle),Mustache.parse(Trillo.HtmlTemplates.titleBarTitlePrefix2),Mustache.parse(Trillo.HtmlTemplates.titleBarTitle2),Trillo.HtmlTemplates.titleBarTemplates__parsed__=!0);var d,e="ol"===this.$titleBarE.prop("tagName").toLowerCase();d=this.$titleBarE.find('[nm="'+a+'-title-prefix"]'),c.length?d.length?d.html(c):d=this.$titleBarE.append(Mustache.render(e?Trillo.HtmlTemplates.titleBarTitlePrefix:Trillo.HtmlTemplates.titleBarTitlePrefix2,{viewName:a,titlePrefix:c})):d.length&&d.remove(),d=this.$titleBarE.find('[nm="'+a+'-title"]'),d.length?d.html(b):d=this.$titleBarE.append(Mustache.render(e?Trillo.HtmlTemplates.titleBarTitle:Trillo.HtmlTemplates.titleBarTitle2,{viewName:a,title:b}))}},a.clearTitle=function(a){0!==this.$titleBarE.length&&(this.$titleBarE.find('[nm="'+a+'-title-prefix"]').remove(),this.$titleBarE.find('[nm="'+a+'-title"]').remove())}}(),function(){"use strict";Trillo.TitleBarManager=function(a){this.options=a,this.table={}};var a=Trillo.TitleBarManager.prototype;a.getTitleBar=function(a,b){return this.table[a]||(debug.debug("Adding titleBar: "+a),this.table[a]=new Trillo.TitleBar({titleBar:a,ownerView:b})),this.table[a]},a.viewCleared=function(a){var b=this,c=null;$.each(b.table,function(){return this.viewOwner===a?(c=this.titleBar,!1):void 0}),c&&(debug.debug("Removing titleBar: "+c),this.table[c].$titleBarE.html(""),this.table[c]=null)}}(),function(){"use strict";Trillo.DragHandler=function(a,b){this.$e=a,this.listener=b,this.dragHandleMouseDownM=$.proxy(this.mouseDownOnDragHandle,this),this.dragHandleMouseUpLeaveM=$.proxy(this.mouseUpLeaveDragHandle,this),this.dragHandleMouseMoveM=$.proxy(this.mouseMoveOnDragHandle,this);var c=a.find(".js-drag-handle, .js-size-handle");c.length>0&&(this.dragHandleMouseDownM=$.proxy(this.mouseDownOnDragHandle,this),this.dragHandleMouseUpLeaveM=$.proxy(this.mouseUpLeaveDragHandle,this),this.dragHandleMouseMoveM=$.proxy(this.mouseMoveOnDragHandle,this),c.on("mousedown",this.dragHandleMouseDownM))};var a=Trillo.DragHandler.prototype;a.dispose=function(){if(this.dragHandleMouseDownM){var a=this.$e.find(".js-drag-handle, .js-size-handle");a.off("mousedown",this.dragHandleMouseDownM);var b=$(document.body);b.off("mouseup mouseleave",this.dragHandleMouseUpLeaveM),b.off("mousemove",this.dragHandleMouseMoveM)}},a._updateDragData=function(a){var b=this.dragData;b.lastX=b.currentX,b.lastY=b.currentY,b.currentX=a.clientX+$(document).scrollLeft(),b.currentY=a.clientY+$(document).scrollTop(),"undefined"==typeof b.initX&&(b.initX=b.currentX,b.initY=b.currentY)},a.mouseDownOnDragHandle=function(a){if(this.dragData)return void this.mouseUpLeaveDragHandle(a);var b=$(a.target);if(b.hasClass("js-drag-handle")||b.hasClass("js-size-handle")){var c=$(document.body);c.off("mouseup",this.dragHandleMouseUpLeaveM),c.on("mouseup",this.dragHandleMouseUpLeaveM),c.off("mousemove",this.dragHandleMouseMoveM),c.on("mousemove",this.dragHandleMouseMoveM),this.dragData={$target:b,userData:null},this._updateDragData(a),this.listener&&this.listener.handleMouseDownOnDragHandle&&this.listener.handleMouseDownOnDragHandle(this.dragData)}},a.mouseUpLeaveDragHandle=function(a){var b=$(document.body);b.off("mouseup",this.dragHandleMouseUpLeaveM),b.off("mousemove",this.dragHandleMouseMoveM),this.listener&&this.listener.handleMouseUpOnDragHandle&&(this._updateDragData(a),this.listener.handleMouseUpOnDragHandle(this.dragData)),this.dragData=null},a.mouseMoveOnDragHandle=function(a){a.preventDefault(),this.listener&&this.listener.handleMouseMoveOnDragHandle&&(this._updateDragData(a),this.listener.handleMouseMoveOnDragHandle(this.dragData))}}(),function(){"use strict";Trillo.BaseView=function(a,b,c){this.$e=a,this.viewSpec=c,this.name=c.name,this._controller=b,this.$c=null,this._nextView=null,this._parentView=null,this._prevView=null,this.selected=null,this.cleared=!0,this.editable=!1,this.internalRoute="",this._embeddedViews=[],this._textNodes=[],this._attrNodes=[],this.scrollTop=-1,b.setView(this),c.embedded||c.autoLoad?(this._parentView=c.prevView,this._parentView._embeddedViews.push(this),this._parentView.controller().addEmbeddedController(b)):(this._prevView=c.prevView,this._prevView&&(this._prevView._nextView=this,this._prevView.controller().setNextController(b)));var d=0;Trillo.isPreview?(c.container=c.container||"main-container",this.$c=this._getContainer(this.viewSpec.container),this.$c&&this.$c.css("width",0===d?"auto":d)):c.container?this.$c=this._getContainer(this.viewSpec.container):this.$c=a.parent().length>0?a.parent():null,this.$c&&(c.dialog=c.dialog||this.$c.hasClass("js-dialog-container")||this.$c.hasClass("js-modal-dialog-container"),this.isModal=c.dialog&&this.$c.hasClass("js-modal-dialog-container")),this._createEmbeddedViews(),this.setupView()};var a=Trillo.BaseView.prototype;a.setupView=function(){debug.debug("setupView() "+this.name);var a=this.$e.html(),b=a&&a.indexOf("{{")>=0;b&&this.$e.length&&this._processNode(this.$e[0],this._textNodes,this._attrNodes),this.toolsMgr=new Trillo.ToolManager(this),this.$e.find("[data-trigger]").each(function(){Trillo.popoverManager.createPopoverForContent($(this))}),this.$e.find("[trigger]").each(function(){Trillo.popoverManager.createPopoverForContent($(this))})},a._getContainer=function(a){var b,c=this.parentView();return c?(b=c.$e.find("[nm='"+a+"']"),b.length?b:c._getContainer(a)):$("[nm='"+a+"']")},a._createEmbeddedViews=function(){var a=this.viewSpec,b=a.embeddedSpecs;if(b&&b.length)for(var c=0;c<b.length;c++){var d=b[c],e=this._getEmbeddedViewElem(d);e&&e.length>0&&(debug.debug("Creating embedded view: "+d.name),e.data("for-view",d.name),Trillo.builder.createView(e,d,this))}},a._getEmbeddedViewElem=function(a){var b=null;return a.elementSelector&&(b=this.$e.find(a.elementSelector)),b||(b=this.$e.find('[nm="'+a.name+'"]')),b},a._processNode=function(a,b,c){var d,e,f;if(3===a.nodeType)d=a.nodeValue,d&&d.indexOf("{{")>=0&&b.push({textNode:a,text:d});else{if(!a.hasAttribute)return;var g=a.getAttribute("for-view")||a.getAttribute("data-for-view");if(g&&g!==this.name)return;var h=a.attributes;if(h){var i;for(e=0,f=h.length;f>e;++e)i=h[e],d=i.nodeValue,d&&d.indexOf("{{")>=0&&c.push({attrNode:i,text:d})}var j=a.childNodes;for(e=0,f=j.length;f>e;++e)this._processNode(j[e],b,c)}},a.show=function(a){var b=$.Deferred();if(a||this.controller().shouldLoadNewData()){debug.debug("View.show() - creating new model for: "+this.viewSpec.name);var c=this.viewSpec.modelSpec;this.customizeModelSpec&&this.customizeModelSpec(c),this.controller().customizeModelSpec&&this.controller().customizeModelSpec(c);var d=this.viewSpec.apiSpec;d&&this.controller().updateApiSpec&&this.controller().updateApiSpec(d);var e=this._controller.createModel();e.done($.proxy(this.showUsingModel,this,b)),e.fail(function(a){b.reject(a)})}else this.postShow(b),debug.debug("View.show() - no changes");return b.promise()},a.showUsingModel=function(a){this._controller.preViewShown(this),this._showUsingModel(a)},a._showUsingModel=function(a){this.model();return this.viewSpec.dialog&&this.$c&&"static"!==this.$c.css("position")&&!this.$c.hasClass("js-dont-position")&&(this.scrollTop=$(window).scrollTop()),this.cleared?(Trillo.router.showingView(this),!this.viewSpec.isAppView&&this.$c&&this.$c.removeClass("trillo-cleared"),this.containerVisibilityChanging(!0),this.$c&&(0===this.$e.parent().length&&this.$c.empty(),(this.$e.parent()[0]!==this.$c[0]||0===this.$e.parent().length)&&this.$c.append(this.$e)),this.viewSpec.dialog&&(this.$c.removeClass("hide"),this.isModal&&(this.$backdropE=$("<div></div>").addClass("trillo-dialog-backdrop"),$("body").append(this.$backdropE))),this.$e.show(),this.render(),this.toolsMgr.activate(),this.setPopoverTriggerState(this.getToolBar$Elem(),!1),this.cleared=!1,void this.postShow(a)):(this.render(),void this.postShow(a))},a.repeatShowUsingModel=function(){var a=$.Deferred();return this._showUsingModel(a),a.promise()},a.render=function(){var a;this.renderTemplateNode(this._textNodes,this._attrNodes);var b=this.$e.find("select");for(a=0;a<b.length;a++)Trillo.setSelectOptionsFromEnum($(b[a]))},a.renderTemplateNode=function(a,b){var c,d;if(a.length||b.length){var e;for(c=0;c<a.length;c++)e=a[c],d=Mustache.render(e.text,this.getData()),d||(d=Mustache.render(e.text,Trillo.appContext)),e.textNode.nodeValue=d;for(c=0;c<b.length;c++)e=b[c],d=Mustache.render(e.text,this.getData()),d||(d=Mustache.render(e.text,Trillo.appContext)),e.attrNode.nodeValue=d}},a.postShow=function(a){if(this._controller.postViewShown(this),a.resolve(this),this.viewSpec.dialog&&"static"!==this.$c.css("position")&&!this.$c.hasClass("js-dont-position")&&(this.updateDialogSize(),this.centerIt()),this.createDragHandle(),this.$c&&Trillo.popoverManager.contentShown(this.$c),Trillo.page.layoutContainers(),this.$c&&this.$c.hasClass("js-non-native-scrollbar")){var b=this;setTimeout(function(){var a={minScrollbarLength:100};a.suppressScrollX=b.$c.width()>b.$e.width(),b.setNonNativeScrollBar(b.$c,a)},0)}},a.postSetup=function(){this._controller.postViewSetup(this)},a.markForClearing=function(){this.viewSpec.isAppView||(this.viewSpec.embedded||Trillo.router.markForClearing(this),this.model()&&this.model().clearObserver()),this._nextView&&this._nextView.markForClearing();for(var a=0;a<this._embeddedViews.length;a++)this._embeddedViews[a].markForClearing()},a.clear=function(){if(!this.cleared){this._controller.preViewCleanup(this),this.toolsMgr.clear(),this.destroyScrollBar(),this.destroyDragHandle(),this.model()&&this.model().clear(),this.$c&&(this.$c.addClass("trillo-cleared"),Trillo.popoverManager.contentCleared(this.$c)),this.$backdropE&&(this.$backdropE.remove(),this.$backdropE=null),this.containerVisibilityChanging(!1),this.$e.hasClass("js-on-clean-no-remove")||this.$e.remove(),this.viewSpec.dialog&&(this.$c.addClass("hide"),-1!==this.scrollTop&&($(window).scrollTop(this.scrollTop),this.scrollTop=-1)),this._prevView?this._prevView._nextView===this&&(this._prevView._nextView=null):this._parentView&&(this._parentView.embeddedViews().splice(this._parentView.embeddedViews().indexOf(this),1),this._parentView._controller.removeEmbeddedController(this._controller));for(var a=0;a<this._embeddedViews.length;a++)this._embeddedViews[a].clear();this.cleared=!0}},a.canSelectionChange=function(a){var b=this._controller.canSelectionChange();b&&this._nextView&&(b=this._nextView.canSelectionChange(a));for(var c=0;c<this._embeddedViews.length&&b;c++)b=this._embeddedViews[c].canSelectionChange(a);return b},a.selectionChanging=function(a){this._controller.selectionChanging(),this._nextView&&this._nextView.selectionChanging(a);for(var b=0;b<this._embeddedViews.length;b++)this._embeddedViews[b].selectionChanging(a)},a.getSelectedObj=function(){return this.selectedObj},a.setSelectedObj=function(a){this.selectedObj=a,this._controller.selectedObjChanged(a),this._controller.updateTitle(),this.setTbState()},a.selectAndRoute=function(a){},a.getToolBar$Elem=function(){if(this.viewSpec.toolBar)return this.$c.find(this.viewSpec.toolBar);var a=this.parentView();return a?a.getToolBar$Elem():$(".js-toolbar")},a.setTbState=function(){this.toolsMgr.setTbState(this.selectedObj),this.setPopoverTriggerState(this.getToolBar$Elem(),!1)},a.setPopoverTriggerState=function(a,b){var c=this.toolsMgr.setPopoverTriggerState(a,b);b=c||b;var d=this.parentView();d&&d.setPopoverTriggerState(a,b)},a.getNextViewName=function(a){return null},a.doInternalRouting=function(a,b){return 0},a.routingToNextView=function(a,b){},a.containerVisibilityChanging=function(a){this.viewSpec.container&&!this.viewSpec.isAppView&&(a?$("body").addClass(this.viewSpec.container+"-shown"):$("body").removeClass(this.viewSpec.container+"-shown"))},a.validate=function(){for(var a=!0,b=0;b<this._embeddedViews.length;b++)a=this._embeddedViews[b].validate()&&a;return a},a.refresh=function(){if(this._nextView)return this._nextView.refresh();for(var a=0;a<this._embeddedViews.length;a++)this._embeddedViews[a].refresh()},a.windowResized=function(){if(!this.cleared){this.viewSpec.dialog&&"static"!==this.$c.css("position")&&!this.$c.hasClass("js-dont-position")&&this.centerIt(),this._nextView&&this._nextView.windowResized();for(var a=0;a<this._embeddedViews.length;a++)this._embeddedViews[a].windowResized();this.updateScrollBar()}},a.updateDialogSize=function(){var a=this.$e,b=this.$c;if(b){var c=a.dataOrAttr("width")||b.dataOrAttr("width");c||(c="auto");var d=a.dataOrAttr("height")||b.dataOrAttr("height");d||(d="auto");var e=a.dataOrAttr("max-width")||b.dataOrAttr("max-width");e||(e=Trillo.Options.DIALOG_MAX_WIDTH),b.css({width:c,height:d,maxWidth:e})}},a.centerIt=function(){var a=$(window),b=this.$c;if(b){var c=a.width(),d=a.height(),e=a.scrollTop(),f=b.outerWidth(),g=b.outerHeight(),h=parseInt(d/2-g/2,10);h>100?h=100:10>h&&(h=10),b.css("top",e+h+"px"),b.css("left",parseInt(c/2-f/2,10)+"px")}},a.hideOverlaidContainer=function(){this.$c&&Trillo.popoverManager.hideCurrentPopupIfContains(this.$c)},a.layoutContainers=function(){this._nextView&&this._nextView.layoutContainers();for(var a=0;a<this._embeddedViews.length;a++)this._embeddedViews[a].layoutContainers()},a.setNonNativeScrollBar=function(a,b){this.destroyScrollBar(),b=b||{suppressScrollX:!0,minScrollbarLength:100},this.$_sb=a,a.perfectScrollbar(b)},a.updateScrollBar=function(){this.$_sb&&this.$_sb.perfectScrollbar("update")},a.destroyScrollBar=function(){this.$_sb&&this.$_sb.perfectScrollbar("destroy")},a.setScrollBarPos=function(a,b){this.$_sb&&("left"==b?this.$_sb.scrollLeft(a):this.$_sb.scrollTop(a),this.updateScrollBar())},a.getScrollBarPos=function(a){return this.$_sb?"left"==a?this.$_sb.scrollLeft():this.$_sb.scrollTop():-1},a.createDragHandle=function(){this.dragHandle&&this.destroyDragHandle();var a=this.$e.find(".js-drag-handle, .js-size-handle");a.length>0&&(this.dragHandle=new Trillo.DragHandler(this.$e,this))},a.destroyDragHandle=function(){this.dragHandle&&(this.dragHandle.dispose(),this.dragHandle=null)},a.objChanged=function(a){},a.objAdded=function(a,b){},a.objDeleted=function(a){},a.modelDataChanged=function(a){a===this.model()&&this.repeatShowUsingModel()},a.showContextMenu=function(a,b){return this.toolsMgr.showContextMenu(a,b)},a.$elem=function(){return this.$e},a.$container=function(){return this.$c},a.controller=function(){return this._controller},a.model=function(){return this._controller.model()},a.getData=function(){return this._controller.getData()},a.getParentData=function(){var a=this.parentView();return a?a.getData():null},a.embeddedViews=function(){return this._embeddedViews},a.parentView=function(){return this._parentView||this._prevView},a.nextView=function(){return this._nextView},a.hide=function(){this.viewSpec.dialog?this.$c.addClass("hide"):this.$e.addClass("hide")},a.unhide=function(){this.viewSpec.dialog?this.$c.removeClass("hide"):this.$e.removeClass("hide")},a.isHidden=function(){return this.viewSpec.dialog?this.$c.hasClass("hide"):this.$e.hasClass("hide")},a.showPageLoadIndicator=function(){$(".js-page-load-indicator").removeClass("hide")},a.hidePageLoadIndicator=function(){$(".js-page-load-indicator").addClass("hide")}}(),function(){"use strict";Trillo.View=Trillo.inherits(Trillo.BaseView,function(a,b,c){Trillo.BaseView.call(this,a,b,c)});var a=Trillo.BaseView.prototype,b=Trillo.View.prototype;b.markForClearing=function(){a.markForClearing.call(this),this.viewSpec.isAppView||this.ownsGlobalProgress&&this.hideGlobalProgress()},b.clear=function(){this.cleared||(Trillo.searchHandler&&Trillo.searchHandler.context===this&&Trillo.searchHandler.setContext(null),this.clearTitle(),Trillo.titleBarManager.viewCleared(this),a.clear.call(this))},b.showGlobalProgress=function(a,b){console.debug("showing .... "+this.viewSpec.name),this.ownsGlobalProgress=!0;var c=$(".js-global-progress-bar");c.show();var d=c.find(".js-title");d.html(a),d=c.find(".js-message"),d.html(b),c.find(".js-progress-bar").css("width",(b||4)+"%")},b.hideGlobalProgress=function(){this.ownsGlobalProgress=!1,console.debug("hiding .... "+this.viewSpec.name);var a=$(".js-global-progress-bar");a.hide()},b.updateProgress=function(a){this._updateProgress(a)},b._updateProgress=function(a){var b=this.parentView();if(b&&b._updateProgress&&b._updateProgress(a))return!0;var c=this._controller.getSelectionUidOrContextUid();return a&&(this.selectedObj&&this.selectedObj.uid===a.uid||c===a.uid)?(a.availabilityState===Trillo.OBJ_LOCKED&&"undefined"!=typeof a.percentComplete?this.showGlobalProgress(a.actionName,a.percentComplete):this.hideGlobalProgress(),!0):!1},b.getTitleBar=function(){if(this.viewSpec.titleBar)return Trillo.titleBarManager.getTitleBar(this.viewSpec.titleBar,this);var a=this.parentView();return a&&a.getTitleBar?a.getTitleBar():Trillo.titleBarManager.getTitleBar(".js-heading",this)},b.updateTitle=function(){var a,b="";if(this.viewSpec.type===Trillo.ViewType.Selector||this.viewSpec.type===Trillo.ViewType.List||this.viewSpec.type===Trillo.ViewType.Nav||this.viewSpec.embedded);else if(Trillo.isCollectionView(this.viewSpec.type)||this.viewSpec.type===Trillo.ViewType.Chart)a=this.viewSpec.displayName||"";else{this.viewSpec.type===Trillo.ViewType.Tree&&(b=this.viewSpec.displayName||"");var c=this.selectedObj;a=c?c.displayName||c.name||"":""}this.setTitle(a,b)},b.setTitle=function(a,b){if(this.title=a,this.titlePrefix=b,""!==b&&b||this.getPrevViewTitle()!==a){var c=this.getTitleBar();c&&c.setTitle(this.name,a,b)}},b.clearTitle=function(){this.title=null,this.titlePrefix=null;var a=this.getTitleBar();a&&a.clearTitle(this.name)},b.getPrevViewTitle=function(){return this._prevView?this._prevView.title:null},b.searchPhraseAvailable=function(a,b,c,d){},b.getNextViewName=function(a){if(this._nextView&&(!a||a===this._nextView.viewSpec.parentPath))return this._nextView.viewSpec.getMyPath();if(a){var b=Trillo.navHistory.get(a);if(b)return b;var c=this.viewSpec.getViewSpecByParentPath(a);if(c)return c.getMyPath()}return this.viewSpec.nextView?this.viewSpec.getDefaultNextPath():this._getNextViewName()},b._getNextViewName=function(){var a=this._controller.getContextUid(),b=this.getNextViewSpecByUidClass(a);return b?b.name:null},b.getNextViewSpecByUidClass=function(a){var b=this.viewSpec.nextViewSpecs,c=null;if(b&&a){var d=Trillo.uidToClass(a);d&&$.each(b,function(a,b){return b.trigger===d?(c=b,!1):void 0})}return c},b.getNextViewSpecNameByUidClass=function(a){var b=this.getNextViewSpecByUidClass(a);return b?b.getMyPath():null},b.routingToNextView=function(a,b){for(var c=a.length,d="",e=b;c>e&&(d=d+(d.length>0?"/":"")+Trillo.getTriggerFromPath(a[e].name),!this.synchWithRouteState(d));e++);},b.synchWithRouteState=function(a){for(var b=0;b<this._embeddedViews.length;b++)this._embeddedViews[b].synchWithRouteState(a);return!0},b.viewSelected=function(a){Trillo.hideCurrentOverlays(!0,!1);var b=Trillo.getActualTarget(a);if(b){Trillo.popoverManager.hideCurrentPopupIfContains(b);var c=b.prop("tagName").toLowerCase();if("a"===c){var d=b.attr("href");if(d&&"#"!==d)return}}a&&a.preventDefault();var e=$(a.target).closest(this.itemCss),f=e.dataOrAttr("nm");this.canSelectionChange(f)&&(this.selectionChanging(f),this.updateItemSelection(f)&&this.postViewSelected(f),$(".js-navbar-toggle").each(function(){$($(this).data("target")).removeClass("in").addClass("collapse")}))},b.updateItemSelection=function(a){$(":focus").blur();var b=this.$e,c=b.find(this.itemCss+"[selected]"),d=!1;return c.dataOrAttr("nm")!==a&&(c.removeClass(Trillo.CSS.selected),c.removeAttr("selected"),c=b.find("[nm='"+a+"']"),c.addClass(Trillo.CSS.selected),c.attr("selected","selected"),d=!0),d},b.getSelected$Elem=function(){return this.$e.find(this.itemCss+"[selected]")},b.getSelectedItem=function(){var a=this.$e.find(this.itemCss+"[selected]");return a.length?a.dataOrAttr("nm"):null},b.selectedItemChanged=function(a){this._controller.selectedItemChanged(a)},b.postViewSelected=function(a){this._controller.routeToSelectedView(this.viewSpec.getNextPath(a))},b.updateLabel=function(){},b.addContainerMarks=function(){var a,b,c=this.$e.find(".js-container");$.each(c,function(){b=$(this),b.empty(),b.addClass(Trillo.CSS.containerPreviewMode),a=$("<span></span>"),b.append(a),a.addClass(Trillo.CSS.containerMark),a.html(b.dataOrAttr("nm")),$("body").addClass(b.attr("nm")+"-shown")})}}(),function(){"use strict";Trillo.EditableView=Trillo.inherits(Trillo.View,function(a,b,c){Trillo.View.call(this,a,b,c),this.messageHtml='<span class="js-field-message '+Trillo.CSS.fieldMsg+' text-info"></span>',this.errorHtml='<span class="js-field-error '+Trillo.CSS.fieldMsg+' text-danger"></span>',this.editable=c.editable!==!1});var a=Trillo.EditableView.prototype,b=Trillo.View.prototype;a.updateFields=function(a,b){$.each(a,function(a,c){c.setValueFromObj(b)})},a.validateOne=function(a){var b=a.$e;if(!b.is(":visible"))return!0;var c=a.validate();if(c&&this.controller().validateOne&&(c=this.controller().validateOne(a)),c&&this.controller().validateAndGetMsg){var d=this.controller().validateAndGetMsg(a);d&&(this.inlineError(b,d),b.parent().addClass(Trillo.CSS.hasErrorCss),c=!1)}return c},a._validate=function(a){for(var b=!0,c=0;c<a.length;c++)b=a[c].validate()&&b;return b},a.showNamedMessages=function(a){var b;if(a)for(var c=0;c<a.length;c++)b=a[c],this.inlineMessage(this.$e.find('[nm="'+b.name+'"]'),b.message)},a.showNamedMessagesAsError=function(a){var b;if(a)for(var c=0;c<a.length;c++)b=a[c],this.inlineError(this.$e.find('[nm="'+b.name+'"]'),b.message)},a.inlineMsg=function(a,b){var c=Trillo.getCreateField(a);c.inlineMsg(b)},a.inlineError=function(a,b){var c=Trillo.getCreateField(a);c.inlineError(b)},a.clearInlineMessage=function(a){var b=Trillo.getCreateField(a);b.clearInlineMessage()},a.clearInlineError=function(a){var b=Trillo.getCreateField(a);b.clearInlineError()},a.fieldChanged=function(a){var b=$(a.target),c=Trillo.getCreateField(b),d=this.validateOne(c);if(d){var e=c.getValue();this.getObjForField(b);return this.updateModelData(c.name,e,b),!0}},a.getFieldValue=function(a){var b=this.$e.find('[nm="'+a+'"]');return this.getFieldValueOf(b)},a.getFieldValueOf=function(a){var b=Trillo.getCreateField(a);return b.getValue()},a.setFieldValue=function(a,b){var c=this.$e.find('[nm="'+a+'"]');this.setFieldValueOf(c,b)},a.setFieldValueOf=function(a,b){var c=Trillo.getCreateField(a);c.setValue(b),c.validate()&&this.updateModelData(c.name,b,a)},a.getInputs=function(){return Trillo.getInputs(this.$e)},a.getReadonly=function(){return Trillo.getReadonly(this.$e)},a.getFields=function(){return this.getFieldsOf(this.$e)},a.getReadonlyFields=function(){return this.getReadonlyFieldsOf(this.$e)},a.getAllFields=function(){return this.getAllFieldsOf(this.$e)},a.getFieldsOf=function(a){return this.getAsFields(Trillo.getInputs(a))},a.getReadonlyFieldsOf=function(a){return this.getAsFields(Trillo.getReadonly(a))},a.getAllFieldsOf=function(a){var b=this.getFieldsOf(a);return b=b.concat(this.getReadonlyFieldsOf(a))},a.getAsFields=function(a){var b=[];return $.each(a,function(){var a=Trillo.getCreateField($(this));b.push(a)}),b},a.postShow=function(a){var c=this.$e.find("textarea");c.length&&(autosize(c),autosize.update(c)),$(".js-default-focus",this.$e).focus(),b.postShow.call(this,a)},a.clear=function(){if(!this.cleared){var a=this.$e.find("textarea");a.length&&autosize.destroy(a)}b.clear.call(this)},a.setAllInputsDisabled=function(a){Trillo.setDisabled(this.getInputs(),a)},a.setInputDisabled=function(a,b){Trillo.setDisabled(this.$e.find('[nm="'+a+'"]'),b)}}(),function(){"use strict";Trillo.EditableObjView=Trillo.inherits(Trillo.EditableView,function(a,b,c){Trillo.EditableView.call(this,a,b,c),this.changeHandler=$.proxy(this.fieldChanged,this)});var a=Trillo.EditableObjView.prototype,b=Trillo.EditableView.prototype;a.render=function(){b.render.call(this),Trillo.fieldFactory.attachFields(this.getInputs(),this),Trillo.fieldFactory.attachReadonlyFields(this.getReadonly(),this),this.setSelectedObj(this.getData()),this.updateProgress(this.getData()),this.setChangeHandler(!0),this.renderData()},a.renderData=function(){var a=this.getData()||{};this.updateFields(this.getAllFields(),a)},a.setChangeHandler=function(a){var b=this.getInputs();b.off("change",this.changeHandler),a&&b.on("change",this.changeHandler)},a.validate=function(){var a=this.getFields(),c=this._validate(a);return c&=b.validate.call(this)},a.clear=function(){this.cleared||this.setChangeHandler(!1),
b.clear.call(this)},a.canSubmit=function(){return this.validate()},a.updateModelData=function(a,b,c){this.model().setValue(a,b)},a.getObjForField=function(a){return this.getData()},a.objChanged=function(a){a===this.getData()&&(this.renderData(),this.updateProgress(a))}}(),function(){"use strict";Trillo.ViewSelectionView=Trillo.inherits(Trillo.View,function(a,b,c){Trillo.View.call(this,a,b,c),this.containerCss=null,this.itemCss=null,this.viewSelectedMethod=$.proxy(this.viewSelected,this)});var a=Trillo.ViewSelectionView.prototype,b=Trillo.View.prototype;a.postShow=function(a){var c=this.$e.find(this.itemCss);c.off("click",this.viewSelectedMethod),c.on("click",this.viewSelectedMethod),b.postShow.call(this,a)},a.clear=function(){if(!this.cleared){var a=this.$e.find(this.itemCss);a.off("click",this.viewSelectedMethod)}b.clear.call(this)},a.synchWithRouteState=function(a){var b=this.$e,c=b.find("[nm='"+a+"']");return c.length>0?(this.updateItemSelection(a),this.updateLabel(),this.controller().updateTitle(),!0):!1},a._getNextViewName=function(){var a=this.$e.find(this.itemCss+"[selected]");return a.length>0?a.dataOrAttr("nm"):null}}(),function(){"use strict";Trillo.TreeView=Trillo.inherits(Trillo.View,function(a,b,c){Trillo.View.call(this,a,b,c);var d=this.$e.find(".js-tree-container"),e=Trillo.findAndSelf(this.$e,".js-non-native-scrollbar");e.length&&this.setNonNativeScrollBar(e),this.tree=new Trillo.Tree({$e:d,parent:this,scrollPolicy:e.length?Trillo.Options.NON_NATIVE_SCROLLBAR:Trillo.isTouchSurface?Trillo.Options.AUTO_SCROLL:Trillo.Options.SCROLL_ON_HOVER,openOnFirstClick:!0,closeOthers:!0}),this.toggleDisplayHandler=$.proxy(this.toggleDisplay,this)});var a=Trillo.TreeView.prototype,b=Trillo.View.prototype;a.clear=function(){this.cleared||(this.removeEventHandlers(),this.tree.clear()),b.clear.call(this)},a.render=function(){b.render.call(this),this.addHandlers(),this.renderData()},a.renderData=function(){var a=this.getData();a=a&&a.children?a.children:[],this.tree.setTreeData(this.getData().children)},a.postShow=function(a){this.selectTreeItem(this.controller().getParam("sel")),b.postShow.call(this,a)},a.selectTreeItem=function(a){var b=this.tree.selectItemByUid(a),c=this.getData().children;!b&&c&&c.length>0&&(a=c[0].uid,this.controller().setParam("sel",a),this.tree.selectItemByUid(a)),this.setSelectedObj(this.tree.getSelectedItem())},a.selectAndRoute=function(a){var b=this.tree.selectItemByUid(a);return b?(this.treeItemSelected(this.tree.getSelectedItem()),!0):!1},a.synchWithRouteState=function(a){var b=this.tree.getItemByUid(a);return b&&b!==this.selectedObj?(this.tree.selectItemByUid(a),this.setSelectedObj(this.tree.getSelectedItem()),!0):!1},a.treeItemSelected=function(a){this.setSelectedObj(a),this.controller().setParam("sel",a.uid)},a.addHandlers=function(){this.viewSpec.viewToggle&&(this.removeEventHandlers(),$(this.viewSpec.viewToggle).on("click",this.toggleDisplayHandler))},a.removeEventHandlers=function(){this.viewSpec.viewToggle&&$(this.viewSpec.viewToggle).off("click",this.toggleDisplayHandler)},a.toggleDisplay=function(){var a=this.$container().offset().left<0;this.$container().css("left",a?"0px":"-1000px")},a.outOfView=function(){this.$container().css("left","-1000px")},a.withInView=function(){this.$container().css("left","0px")},a.getNextViewName=function(a){var c=this.selectedObj;return c?Trillo.isUid(c.uid)?this.getNextViewSpecNameByUidClass(c.uid):this.viewSpec.getNextPath(c.uid):b.getNextViewName.call(this,a)},a.refresh=function(){this.tree.refresh(),b.refresh.call(this)}}(),function(){"use strict";Trillo.NavTreeView=Trillo.inherits(Trillo.TreeView,function(a,b,c){Trillo.TreeView.call(this,a,b,c)});var a=Trillo.NavTreeView.prototype;a.customizeModelSpec=function(a){a.data={children:this.viewSpec.nextViewSpecs||[]}}}(),function(){"use strict";Trillo.SelectorView=Trillo.inherits(Trillo.ViewSelectionView,function(a,b,c){Trillo.ViewSelectionView.call(this,a,b,c),this.labelSelector=".js-label",this.containerCss=".js-menu",this.itemCss=".js-menu-item"});var a=Trillo.SelectorView.prototype;a.updateLabel=function(){var a=this.$e,b=a.find(this.itemCss+"[selected]");a.find(this.labelSelector).html(b.html())}}(),function(){"use strict";Trillo.TabView=Trillo.inherits(Trillo.EditableObjView,function(a,b,c){Trillo.EditableObjView.call(this,a,b,c),this.containerCss=".js-tab-list",this.itemCss=".js-tab",this.tabPanelCSS=".js-tab-panel",this.viewSelectedMethod=$.proxy(this.viewSelected,this),this.$inputs=Trillo.getInputs(a),this.changeHandler=$.proxy(this.fieldChanged,this)});var a=Trillo.TabView.prototype,b=Trillo.EditableObjView.prototype;a.getInputs=function(){return this.$inputs},a.postShow=function(a){var c,d,e=null,f=Trillo.navHistory.get("tab://"+this.controller().getRouteUpTo(!1));c=this.$e.find(this.itemCss+"[selected]"),c.length>0&&(e=c.dataOrAttr("nm")),f&&f!==e&&(e=f,this.synchWithRouteState(e)),e&&(d=this.$e.find(this.tabPanelCSS+"[for='"+e+"']"),d.length>0&&this.updateTabPanelVisibility(e));var g=this.$e.find(this.itemCss);g.off("click",this.viewSelectedMethod),g.on("click",this.viewSelectedMethod),this.makeResponsive(),b.postShow.call(this,a)},a.clear=function(){if(!this.cleared){var a=this.$e.find(this.itemCss);a.off("click",this.viewSelectedMethod)}b.clear.call(this)},a.updateLabel=function(){var a=this.$e,b=a.find(this.itemCss+"[selected]");a.find("."+Trillo.CSS.tabActive).removeClass(Trillo.CSS.tabActive),b.parent().addClass(Trillo.CSS.tabActive)},a.updateTabPanelVisibility=function(a){var b=this.$e;b.find(this.tabPanelCSS+"[for]").hide();var c=b.find(this.tabPanelCSS+"[for='"+a+"']");c.show(),Trillo.resizeAllTextArea(b),this.refresh()},a.postViewSelected=function(a){var c=this.$e.find(this.tabPanelCSS+"[for='"+a+"']");c.length>0?(this.updateTabPanelVisibility(a),this.updateLabel(),this.selectedItemChanged(a),Trillo.navHistory.add("tab://"+this.controller().getRouteUpTo(!1),a)):b.postViewSelected.call(this,a)},a._getNextViewName=function(){var a,b,c=Trillo.navHistory.get("tab://"+this.controller().getRouteUpTo(!1));return c&&(b=this.$e.find(this.tabPanelCSS+"[for='"+c+"']"),b.length>0),a=this.$e.find(this.itemCss+"[selected]"),a.length>0?(c=a.dataOrAttr("nm"),b=this.$e.find(this.tabPanelCSS+"[for='"+c+"']"),b.length>0?null:c):null},a.synchWithRouteState=function(a){var b=this.$e,c=b.find("[nm='"+a+"']");return c.length>0?(this.updateItemSelection(a),this.updateLabel(),this.controller().updateTitle(),!0):!1},a.objChanged=function(a){b.objChanged.call(this,a),a===this.getData()&&this.setTbState()},a.makeResponsive=function(){var a,b=this.$e,c=b.find("li"),d=0;$.each(c,function(){$(this).is(":visible")&&d++}),d>0&&c.css("width",100/d+"%"),$.each(c,function(){a=$(this),a.attr("title")||a.attr("title",$.trim(a.text()))})},a.showHideTab=function(a,b){var c=this.$e.find("[nm='"+a+"']");c.length>0&&(b?c.parent().removeClass("hide"):c.parent().addClass("hide"),this.makeResponsive())},a.showTab=function(a){this.showHideTab(a,!0)},a.hideTab=function(a){this.showHideTab(a,!1)}}(),function(){"use strict";Trillo.NavView=Trillo.inherits(Trillo.ViewSelectionView,function(a,b,c){Trillo.ViewSelectionView.call(this,a,b,c),this.containerCss=".js-navigation",this.itemCss=".js-nav-item"})}(),function(){"use strict";Trillo.sortDescTemplate='<span class="order"><span class="caret"></span></span>',Trillo.sortAscTemplate='<span class="order dropup"><span class="caret"></span></span>',Trillo.CollectionView=Trillo.inherits(Trillo.View,function(a,b,c){Trillo.View.call(this,a,b,c)});var a=Trillo.CollectionView.prototype,b=Trillo.View.prototype;a.setupView=function(){var a={},c=this.viewSpec,d=this.$e,e=d.find(".js-grid-cell");this.sortSpec={},e.length>0?(a.elemKey=c.name+"-info-block",Trillo.infoElementRepo.addTemplate(e,a.elemKey)):(e=d.find(".js-content-row"),e.length>0&&(a.elemKey=c.name+"-row",Trillo.infoElementRepo.addTemplate(e,a.elemKey),a.isListViewMode=!0)),e=d.find(".js-heading-row"),e.length>0&&(e.show(),a.$headerRow=e),a.postRenderer=c.postRenderer,a.dialog=c.dialog,a.virtual=c.virtual||"undefined"==typeof c.virtual?!0:!1,this.$asc=$(Trillo.sortAscTemplate),this.$desc=$(Trillo.sortDescTemplate),this.$e.hasClass("js-non-native-scrollbar")&&this.setNonNativeScrollBar(this.$e),this.canvas=new Trillo.Canvas(this,a),b.setupView.call(this)},a.render=function(){var a=this.model().getPaginationInfo();a&&1!==a.numberOfPages||(this.viewSpec.virtual=!1,this.canvas.virtual=!1),this.controller().updateTitle(),b.render.call(this),this.renderData()},a.renderData=function(){this.canvas.clear(),this.canvas.setContent(this._modelDataWithPagination())},a.clear=function(){this.cleared||(this.unselectInfoItem(),this.canvas.clear()),b.clear.call(this)},a.windowResized=function(){this.cleared||(this.canvas.windowResized(),b.windowResized.call(this))},a.layoutContainers=function(){this.cleared||(this.canvas.windowResized(),b.layoutContainers.call(this))},a.loadPage=function(a,b){$.when(this.controller().loadData(a,b)).done($.proxy(this.pageLoaded,this,b))},a.pageLoaded=function(a,b){a&&this.canvas.clear(),this.canvas.setContent(this._modelDataWithPagination())},a.postShow=function(a){this.selectCollectionItem(this.controller().getParam("sel")),b.postShow.call(this,a)},a.selectCollectionItem=function(a){var b=this.canvas.selectItemByUid(a);if(!b&&this.hasSelectionTrigger()){var c=this.getData();c&&c.length>0&&(a=c[0].uid,this.controller().setParam("sel",a),b=this.canvas.selectItemByUid(a))}},a.selectInfoItem=function(a){this.selectedInfoItem=a,a&&(this.setSelectedObj(a.obj),this.hasSelectionTrigger()&&a.obj&&this.controller().setParam("sel",a.obj.uid))},a.unselectInfoItem=function(a){this.selectedInfoItem=null,this.setSelectedObj(null)},a.clicked=function(a,b){return a&&a.obj&&a.obj.name?this.controller()._handleClickGeneric(a.obj.name,a.$rootE,a.obj,b):void 0},a.infoItemDblClicked=function(a,b){return a&&a.obj&&!this.hasSelectionTrigger()?this.controller().doTriggerNextView("detail",a.obj):!1},a.hasSelectionTrigger=function(){return this.viewSpec.getNextViewSpecByTrigger("selection")},a.objChanged=function(a){this.canvas.objChanged(a),this.selectedObj===a&&this.setTbState(),b.objChanged.call(this,a)},a.objAdded=function(a,c){this.canvas.objAdded(a,c),b.objAdded.call(this,a,c)},a.doSort=function(a){var b=$(a.target);if(b=Trillo.getClosestLabelElem(b),!b)return void Trillo.alert.showError("Error","Missing 'for' attribute in the header, pl. specify in the HTML temlpate");var c=b.dataOrAttr("for"),d=this.sortSpec[c];if(d="asc"===d?"desc":"asc",this.$asc.remove(),this.$desc.remove(),"asc"===d?b.append(this.$asc):b.append(this.$desc),this.sortSpec={},this.sortSpec[c]=d,this.model().setOrderBy){var e=c+" "+d;this.model().setOrderBy(e),this.canvas.loadingData=!0,this.loadPage(1,!0)}else this.model().doSort(c,d),this.canvas.clear(),this.canvas.setContent(this._modelDataWithPagination())},a.refresh=function(){this.canvas.refresh(),b.refresh.call(this)},a.changeAttr=function(a,b,c){this.model().setObjAttr(a,b,c)},a._modelDataWithPagination=function(){var a=this.getData();a||(a=[]);var b=this.model().getPaginationInfo();return b||(b=Trillo.makePaginationInfo(a)),b.items=a,b}}(),function(){"use strict";Trillo.DropdownView=Trillo.inherits(Trillo.ViewSelectionView,function(a,b,c){Trillo.ViewSelectionView.call(this,a,b,c),this.labelSelector=".js-label",this.containerCss=".js-navigation",this.listCss=".js-list",this.itemCss=".js-list-item",this.itemSelectedMethod=$.proxy(this.itemSelected,this)});var a=Trillo.DropdownView.prototype,b=Trillo.ViewSelectionView.prototype;a.render=function(){this.controller().updateTitle(),b.render.call(this),this.renderList()},a.renderList=function(){var a=this.$e.find(this.listCss),b=this.getData()||[];Trillo.HtmlTemplates.dropdownListItem&&!Trillo.HtmlTemplates.dropdownListItem__parsed__&&(Mustache.parse(Trillo.HtmlTemplates.dropdownListItem),Trillo.HtmlTemplates.dropdownListItem__parsed__=!0);for(var c="",d=0;d<b.length;d++){var e=b[d];c+=Mustache.render(Trillo.HtmlTemplates.dropdownListItem,e)}a.html(c)},a.postShow=function(a){this.selectItem(),b.postShow.call(this,a)},a.selectItem=function(){var a=this.controller().getParam("sel"),b=null;a&&(b=this.model().getObj(a));var c=this.getData();!b&&c.length>0&&(b=c[0],a=b.uid,this.controller().setParam("sel",a)),this.setSelectedObj(b)},a.synchWithRouteState=function(a){b.synchWithRouteState.call(this,a);var c=this.model().getObj(a);c&&c!==this.selectedObj&&this.setSelectedObj(c)},a.setSelectedObj=function(a){b.setSelectedObj.call(this,a),this.updateLabel()},a.postViewSelected=function(a){var b=this.model().getObj(a);this.setSelectedObj(b);var c=b?b.uid:null;this.controller().setParam("sel",c)},a.updateLabel=function(){var a=this.selectedObj,b=a?a.name:"";this.$e.find(this.labelSelector).html(b)},a._getNextViewName=function(){var a=this.selectedObj;return a?Trillo.isUid(a.uid)?null:a.uid:void 0},a.objChanged=function(a){this.renderList(),this.selectedObj===a&&this.setTbState(),b.objChanged.call(this,a)},a.objAdded=function(a,c){this.renderList(),this.selectedObj||this.selectItem(),b.objAdded.call(this,a,c)}}(),function(){"use strict";Trillo.DetailView=Trillo.inherits(Trillo.EditableObjView,function(a,b,c){Trillo.EditableObjView.call(this,a,b,c)})}(),function(){"use strict";Trillo.FormView=Trillo.inherits(Trillo.EditableObjView,function(a,b,c){Trillo.EditableObjView.call(this,a,b,c)})}(),function(){"use strict";Trillo.EditableTableView=Trillo.inherits(Trillo.EditableView,function(a,b,c){Trillo.EditableView.call(this,a,b,c)});var a=Trillo.EditableTableView.prototype,b=Trillo.EditableView.prototype;a.setupView=function(){this.allowsNewRow="undefined"==typeof this.viewSpec.allowsNewRow||this.viewSpec.allowsNewRow,this.$templateE=this.$e.find(".js-content-row"),this.$templateE.remove(),this.changeHandler=$.proxy(this.rowFieldChanged,this),this.rowActionHandler=$.proxy(this.handleRowAction,this),this.keydownHandler=$.proxy(this.keydownAction,this),this.isStringArray=!1,b.setupView.call(this)},a.render=function(){b.render.call(this),this.$tableE=Trillo.findAndSelf(this.$e,"table"),this.renderData()},a.renderData=function(){var a=this.getData();if(a=a?Trillo.convertToArray(a):[],a.length&&"string"==typeof a[0]){this.isStringArray=!0;var b=[];$.each(a,function(){b.push({name:this})}),a=b}this.clearRows(),this.makeEmptyData(),this.clearRows(),this.setRowsData(a),this.addLastEmptyRow()},a.clearRows=function(){this.$e.find(".js-content-row").remove()},a.setRowsData=function(a){for(var b=0;b<a.length;b++){var c=this.appendNewRow(b);c.data("_row_data_",a[b]),this.updateFields(this.getAllFieldsOf(c),a[b])}},a.refreshRowsView=function(){for(var a=this.$e.find(".js-content-row"),b=0;b<a.length;b++){var c=$(a[b]),d=c.data("_row_data_");d&&this.updateFields(this.getAllFieldsOf(c),d)}},a.appendNewRow=function(a){var b=this.$templateE.clone(!0);return b.attr("row",""+a),this.$tableE.append(b),b.data("_row_data_",{}),this.addRowEventHandler(b),b},a.makeEmptyData=function(){this.appendNewRow();var a=[];this._viewToData(a,!0,!0),this.emptyData=a[0]},a.retrieveData=function(a){var b={},c=this.getAsFields(a);return $.each(c,function(a,c){var d=c.getValue();null!==d&&void 0!==d&&Trillo.setObjectValue(b,c.name,d)}),b},a._viewToData=function(a,b,c){var d=null;c||(d=this.model().cloneData()),a.length=0;var e,f=this.$e.find(".js-content-row"),g=this;$.each(f,function(){e=$(this);var c=Trillo.getInputs(e);if(b||!g.isEmpty(c)){var d=g.retrieveData(c);if(g.isStringArray)a.push(d.name);else{var f=e.data("_row_data_");Trillo.clearObj(f),d=$.extend(f,d),a.push(d)}}}),c||this.model().recrodDataChange(d,{obj:this.getParentData(),viewName:this.name})},a.addRowEventHandler=function(a){var b=Trillo.getInputs(a);b.on("change",this.changeHandler),b.on("keydown",this.keydownHandler),b=a.find(".js-row-tool"),b.on("click",this.rowActionHandler)},a.validate=function(){var a,c=this.$e.find(".js-content-row"),d=!0,e=this;return $.each(c,function(){a=$(this);var b=Trillo.getInputs(a);e.isEmpty(b)||(d=e._validate(this.getFieldsOf(b))&&d)}),d&=b.validate.call(this)},a.isEmpty=function(a){var b=!0,c=this.emptyData||{},d=this;return $.each(a,function(){var a=$(this),e=d.getFieldValueOf(a),f=c[a.attr("nm")];return e!==f?(b=!1,!1):void 0}),b},a.rowFieldChanged=function(a){if(this.fieldChanged(a)){var b=$(a.target);this.isLastRow(b)&&this.addLastEmptyRow()}},a.isLastRow=function(a){var b=this.getNumberOfRows(),c=this.getRowIndex(a);return c===b-1},a.getNumberOfRows=function(){return this.$e.find(".js-content-row").length},a.handleRowAction=function(a){var b=$(a.target);switch(b.attr("nm")){case"up":this.moveRow(b,-1);break;case"down":this.moveRow(b,1);break;case"add":this.addRowBefore(b);break;case"delete":this.deleteRow(b);break;default:this.controller().handleAction(b.attr("nm"),this.getObjForField(b),b)}},a.moveRow=function(a,b){var c=this.getRowIndex(a)+b;if(!(0>c)){var d=this.getNumberOfRows();c>=d||(0>b?this.$e.find('[row="'+c+'"]').before(a.closest("tr")):this.$e.find('[row="'+c+'"]').after(a.closest("tr")),this.reorder(),this._viewToData(this.getData(),!0))}},a.addRowBefore=function(a){var b=this.$templateE.clone(!0);a.closest("tr").before(b),this.addRowEventHandler(b),this.reorder(),this._viewToData(this.getData(),!0)},a.deleteRow=function(a){a.closest("tr").remove(),0===this.getNumberOfRows()?this.appendNewRow(0):this.reorder(),this._viewToData(this.getData(),!0)},a.reorder=function(){var a=this.$e.find(".js-content-row"),b=0;$.each(a,function(){$(this).attr("row",b++)})},a.getRowIndex=function(a){return parseInt(a.closest("tr").attr("row"),10)},a.removeLastRowIfEmpty=function(){var a=this.$e.find(".js-content-row").last();this.isEmpty(a)&&a.remove()},a.addLastEmptyRow=function(){!this.editable||!this.allowsNewRow||0!==this.getData().length&&this.isEmpty(Trillo.getInputs(this.$e.find(".js-content-row").last()))||(this.appendNewRow(this.getNumberOfRows()),this._viewToData(this.getData(),!0,!0))},a.setAllowsNewRow=function(a){a!==this.allowsNewRow&&(this.allowsNewRow=a,a?this.addLastEmptyRow():this.removeLastRowIfEmpty())},a.updateModelData=function(a,b,c){var d=this.model().cloneData();this.model().setObjAttrNoRecording(this.getObjForField(c),a,b),this.refreshRowsView(),this.model().recrodDataChange(d,{obj:this.getParentData(),viewName:this.name})},a.getObjForField=function(a){var b=this.getRowIndex(a);return this.getData()[b]},a.keydownAction=function(a){var b=a.which;if(38===b||40===b||13===b){var c=$(a.target);if(c.is("select")&&13!=b)return;var d=this.getRowIndex(c);if(d+=38===b?-1:1,0>d||d>=this.getNumberOfRows())return;var e=c.closest(".js-content-row"),f=Trillo.getInputs(e),g=f.index(c);e=this.$e.find('[row="'+d+'"]'),f=Trillo.getInputs(e),c=$(f.get(g)),c.focus()}},a.getRowElemForObj=function(a){var b,c=this.$e.find(".js-content-row"),d=null;return $.each(c,function(){return b=$(this).data("_row_data_"),b===a?(d=$(this),!1):void 0}),d}}(),function(){"use strict";Trillo.ChartView=Trillo.inherits(Trillo.View,function(a,b,c){Trillo.View.call(this,a,b,c),this.charts=[]});var a=Trillo.ChartView.prototype,b=Trillo.View.prototype;a.render=function(){this.controller().updateTitle(),b.render.call(this),this.renderCharts()},a.clear=function(){b.clear.call(this),this.chart=null},a.windowResized=function(){if(!this.cleared){b.windowResized.call(this);for(var a=0;a<this.charts.length;a++)this.charts[a].resize()}},a.loadPage=function(a){$.when(this.controller().loadData(a)).done($.proxy(this.pageLoaded,this))},a.pageLoaded=function(a){},a.renderCharts=function(){var a=this.viewSpec;a.chartSpecs&&this._renderCharts(a.chartSpecs)},a._renderCharts=function(a){var b;for(this.charts.length=0,b=0;b<a.length;b++)this.renderChart(a[b])},a.renderChart=function(a){if(debug.debug("Rendering chart: "+a.name),a.axis&&a.axis.x&&"timeseries"===a.axis.x.type&&a.axis.x.tick){var b=Trillo.getRefByQualifiedName(a.axis.x.tick);b&&(a.axis.x.tick=b)}"pie"===a.type||"donut"===a.type||"gauge"===a.type?this.renderSliceChart(a):this.renderXYChart(a)},a.renderXYChart=function(a){var b,c,d,e,f=[],g=[],h=Trillo.chartDataFromModelData(a.name,this.getData()),i=a.xAttr,j=a.yAttrs;for(f.push(i),e=0;e<h.length;e++)h[e][i]&&f.push(h[e][i]);for(g.push(f),e=0;e<j.length;e++){c=j[e],d=c,b=[],b.push(d);for(var k=0;k<h.length;k++)"undefined"!=typeof h[k][c]&&b.push(h[k][c]);g.push(b)}var l={x:i,columns:g,type:a.type,groups:a.groups},m={bindto:"#"+this.viewSpec.elemId+" .chart",data:l,axis:a.axis};this.updateOptions(m,a),m.legend=m.legend||{show:!0},m.transition=m.transition||{duration:0};var n=c3.generate(m);this.setChartElement(a,n)},a.renderSliceChart=function(a){var b,c,d,e,f,g=[],h=Trillo.chartDataFromModelData(a.name,this.getData()),i=a.xAttr,j=a.yAttrs;if(j&&0!==j.length){if(i){var k=j[0];for(e=0;e<h.length;e++)f=[],f.push(h[e][i]),f.push(h[e][k]),g.push(f)}else for(d=0;d<j.length;d++){for(b=j[d],c=b,f=[],f.push(c),e=0;e<h.length;e++)"undefined"!=typeof h[e][b]&&f.push(h[e][b]);g.push(f)}var l,m={columns:g,type:a.type};a.label&&(l={label:{format:function(b,c,d){return b+" "+a.label}}});var n={data:m};l&&("pie"===a.type?n.pie=l:"donut"===a.type?n.donut=l:"gauge"===a.type&&(n.gauge=l)),this.updateOptions(n,a);var o=c3.generate(n);this.setChartElement(a,o)}},a.updateOptions=function(a,b){var c={xAttr:!0,yAttrs:!0,type:!0,displayName:!0,label:!0,groups:!0};$.each(b,function(b,d){c[b]||(a[b]=d)})},a.setChartElement=function(a,b){var c=$("[nm='"+a.name+"']",this.$e);0===c.length&&(c=$(".js-chart-cell-preview",this.$e)),c.find(".js-chart")[0].appendChild(b.element),a.displayName&&c.find(".js-title").html(a.displayName?a.displayName:""),this.charts.push(b)},a.createTestData=function(){var a=[],b=new Date;b.setTime(b.getTime()-864e5);for(var c=0;10>c;c++)a.push({timeStamp:b.getTime(),cpuUsage:Math.floor(Math.random()*(c%4===0?20:10))+1,cpuReady:Math.floor(Math.random()*(c%4===0?10:5))+1,cpuMhz:Math.floor(Math.random()*(c%4===0?150:600))+1,memoryMb:Math.floor(Math.random()*(c%4===0?20:100))+1,memorySwapOut:Math.floor(Math.random()*(c%4===0?1:5))+1,memorySwapIn:Math.floor(Math.random()*(c%4===0?1:3))+1,itemName:"Time-"+c}),b.setTime(b.getTime()+18e5);this.model().data={items:a}}}(),function(){"use strict";Trillo.ContentView=Trillo.inherits(Trillo.View,function(a,b,c){Trillo.View.call(this,a,b,c)});var a=Trillo.ContentView.prototype;a.doInternalRouting=function(a,b){var c=a.length-b;0>c&&(c=0);for(var d=this.$e,e=Trillo.findAndSelf(d,'[nm="'+this.name+'"]'),f="",g=0;c>g;g++){var h=d.find('[nm="'+a[b+g].name+'"]');h.length>0&&(e=h),f=f+(g>0?"/":"")+a[b+g].name}this.internalRoute=f;var i=this.parentView();if(i&&"toc"===i.viewSpec.type){d.find(".js-pointed").remove();var j=$("<span></span>");j.addClass(Trillo.CSS.pointed+" js-pointed");var k=e.find(":first-child").filter(":header");if(k.length){k=$(k[0]),k.prepend(j);var l=parseInt(k.css("height"),10)/2;j.css("top",l),i.synchWithRouteState(e.dataOrAttr("nm"))}this.scrollIntoView(e)}else c=0;return c},a.scrollIntoView=function(a){var b=this.$e.offset().top,c=a.offset().top-b;setTimeout(function(){$(window).scrollTop(c)},0)},a.getNextViewName=function(a){return null}}(),function(){"use strict";Trillo.TocView=Trillo.inherits(Trillo.ViewSelectionView,function(a,b,c){Trillo.ViewSelectionView.call(this,a,b,c),this.itemCss=".js-item",this.viewSelectedMethod=$.proxy(this.viewSelected,this);var d=Trillo.findAndSelf(this.$e,".js-non-native-scrollbar");d.length?this.setNonNativeScrollBar(d):(this.mouseOverHandler=$.proxy(this.onMouseOver,this),this.mouseOutHandler=$.proxy(this.onMouseOut,this),this.delayedOnMouseOut=$.proxy(this._onMouseOut,this))});var a=Trillo.TocView.prototype,b=Trillo.ViewSelectionView.prototype;a.postShow=function(a){this.mouseOverHandler&&(this.$e.on("mouseover",this.mouseOverHandler),this.$e.on("mouseout",this.mouseOutHandler)),this.updateScrollBar(),b.postShow.call(this,a)},a.clear=function(){this.mouseOverHandler&&(this.$e.off("mouseover",this.mouseOverHandler),this.$e.off("mouseout",this.mouseOutHandler)),b.clear.call(this)},a.getNextViewName=function(a){var c=this.$e.find(".js-item");return c.length>0?this.viewSpec.getNextPath(c.dataOrAttr("nm")):b.getNextViewName.call(this,a)},a._getNextViewName=function(){return null},a.routingToNextView=function(a,b){for(var c=a.length,d=c-1;d>=b&&!this.synchWithRouteState(Trillo.getTriggerFromPath(a[d].name));d--);},a.viewSelected=function(a){Trillo.hideCurrentOverlays(!0,!0),a&&(a.stopPropagation(),a.preventDefault());var b=$(a.target).closest(this.itemCss),c=b.dataOrAttr("nm");if(this.updateItemSelection(c)){var d=b.parents(this.itemCss);d=d.map(function(){return $(this).dataOrAttr("nm")}).get();var e;d.length?(d=d.reverse(),e=d.join("/")+"/"+c):e=c,this.postViewSelected(e)}this.containerVisibilityChanging(!0)},a.clearTimeout=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},a.onMouseOver=function(){this.clearTimeout(),this.$e.find(".js-toc-container").css("overflow","auto")},a.onMouseOut=function(){this.clearTimeout(),this.timer=setTimeout(this.delayedOnMouseOut,1e3)},a._onMouseOut=function(){this.clearTimeout(),this.$e.find(".js-toc-container").css("overflow","hidden")}}(),function(){"use strict";Trillo.FlexGridView=Trillo.inherits(Trillo.View,function(a,b,c){Trillo.View.call(this,a,b,c)});var a=Trillo.FlexGridView.prototype,b=Trillo.View.prototype;a.setupView=function(){var a=this.$e.find(".js-flex-grid");0===a.length?a=this.$e:a.length>1&&(a=$(a[0])),this.$gridElem=a,this.gridSpec={$e:a,id:this.name},this.specs=[],this.$c&&this.$c.append(this.$e),this.lastId=0,this.updateRowSpecs(a,this.specs),this.$iconBar=this.$e.find(".js-flex-grid-iconbar"),this.$minifyIcon=this.$e.find(".js-flex-minified-icon"),this.$minifyIcon.remove(),0===this.$iconBar.children().length&&this.$iconBar.addClass("hide"),this.showHideSpecs=[],this.makeShowHideSpecs(this.specs),b.setupView.call(this)},a.updateRowSpecs=function(a,b){var c,d,e=(this.name,this),f=a.children();f.each(function(){c=$(this),c.hasClass("js-flex-row")&&(d=e.makeRowSpec(c,e.gridSpec,"row"),b.push(d),e.updateRowChildrenSpecs(d))})},a.updateRowChildrenSpecs=function(a){var b,c,d,e,f=[],g=a.$e.children();if(1!=g.length||(e=$(g[0]),e.hasClass("js-flex-col")||e.hasClass("js-flex-cell"))){var h=this;g.each(function(){b=$(this),c=b.hasClass("js-flex-col")?"col":"cell","col"===c?(d=h.makeColSpec(b,a,c),h.updateColChildrenSpecs(d)):d=h.makeCellSpec(b,a,c),f.push(d)}),a.children=f}},a.updateColChildrenSpecs=function(a){var b,c,d,e,f=[],g=a.$e.children();if(1!=g.length||(e=$(g[0]),e.hasClass("js-flex-row")||e.hasClass("js-flex-cell"))){var h=this;g.each(function(){b=$(this),d=b.hasClass("js-flex-row")?"row":"cell","row"===d?(c=h.makeRowSpec(b,a,d),h.updateRowChildrenSpecs(c)):c=h.makeCellSpec(b,a,"cell"),f.push(c)}),a.children=f}},a.makeBaseSpec=function(a,b,c){var d;d=a.dataOrAttr("id"),d||(d=b.id+"."+ ++this.lastId,a.attr("id",d));var e={$e:a,id:d,type:c,flexWidth:!0,flexHeight:!0,parent:b};return e},a.makeRowSpec=function(a,b,c){var d=this.makeBaseSpec(a,b,c);return this.updateCommonAttributes(d),d},a.makeColSpec=function(a,b,c){var d=this.makeBaseSpec(a,b,c);return this.updateCommonAttributes(d),d},a.makeCellSpec=function(a,b,c){var d=this.makeBaseSpec(a,b,c);return a.hasClass("js-flex-cell")||a.addClass("js-flex-cell"),this.updateCommonAttributes(d),d},a.makeShowHideSpecs=function(a){var b,c,d,e=this,f=function(){var a=$(this),b={},c=a.dataOrAttr("show-exp");c&&(b.showExp=e.parseExp(c)),c=a.dataOrAttr("hide-exp"),c&&(b.hideExp=e.parseExp(c)),(b.hideExp||b.showSpec)&&(b.$e=a,e.showHideSpecs.push(b))};for(c=0;c<a.length;c++)b=a[c],b.children&&0!==b.children.length?this.makeShowHideSpecs(b.children):(d=$("[show-exp], [hide-exp]",b.$e),d.each(f))},a.updateCommonAttributes=function(a){var b,c,d,e=a.$e;this.setMargins(a,e),this.setPaddings(a,e),this.setBordersWidth(a,e),this.setNonContentExtra(a),d=e.dataOrAttr("min-width"),b=d?parseInt(d,10):void 0,Trillo.isNumeric(b)||(b=-1),d=e.dataOrAttr("min-height"),c=d?parseInt(d,10):void 0,Trillo.isNumeric(c)||(c=-1),a.inputMinW=b,a.inputMinH=c,d=e.dataOrAttr("max-width"),b=d?parseInt(d,10):void 0,Trillo.isNumeric(b)||(b=Number.MAX_VALUE),d=e.dataOrAttr("max-height"),c=d?parseInt(d,10):void 0,Trillo.isNumeric(c)||(c=Number.MAX_VALUE),a.inputMaxW=b,a.inputMaxH=c,d=e.dataOrAttr("flex-width"),d&&(d=d.toLowerCase(),a.flexWidth=!("false"===d||"no"===d)),d=e.dataOrAttr("flex-height"),d&&(d=d.toLowerCase(),a.flexHeight=!("false"===d||"no"===d)),d=e.dataOrAttr("show-exp"),d&&(a.showExp=this.parseExp(d)),d=e.dataOrAttr("hide-exp"),d&&(a.hideExp=this.parseExp(d));var f=e.css("position");f=f?f.toLowerCase():"","fixed"!==f&&"absolute"!==f&&(e.width(e.width()),e.height(e.height()),e.css("position","absolute"))},a.parseExp=function(a){if(!a)return null;var b=a.replace(new RegExp("[0-9]","g"),""),c=a.replace(new RegExp("\\D","g"),"");return{op:$.trim(b),val:parseInt(c,10)}},a.processShowHideSpecs=function(){for(var a,b,c=Trillo.getViewportWidth(),d=0;d<this.showHideSpecs.length;d++)a=this.showHideSpecs[d],b=a.$e.css("display"),a.showExp?this.isTrue(a.showExp,c)?"none"===b&&(a.display="none",a.$e.css("display","")):"none"===a.display&&(a.$e.css("display","none"),a.display=""):a.hideExp&&(this.isTrue(a.hideExp,c)?"none"!==b&&(a.display=a.$e.css("display"),a.$e.css("display","none")):a.display&&(a.$e.css("display",a.display),a.display=null))},a.makeVisibleList=function(a){var b,c,d=[];for(c=0;c<a.length;c++)b=a[c],this.isDetached(b)||(this.isHidden(b)?b.$e.css("left","-10000px"):((b.showExp||b.hideExp)&&("none"===b.$e.css("display")&&b.$e.css("display",""),"hidden"===b.$e.css("visibility")&&b.$e.css("visibility","visible")),"cell"!==b.type&&b.children&&0!==b.children.length||(b.$e.css({height:""}),b.$e.css({width:""})),b.children?(b.vcl=this.makeVisibleList(b.children),d.push(b)):d.push(b)));return d},a.isDetached=function(a){return a.parent.$e[0]!==a.$e.parent()[0]},a.isHidden=function(a){var b=Trillo.getViewportWidth();return a.$e.hasClass("js-container")&&0===a.$e.children().length?!0:(a.showExp?this.isTrue(a.showExp,b)?a.$e.removeClass("trillo-hidden"):a.$e.addClass("trillo-hidden"):a.hideExp&&(this.isTrue(a.hideExp,b)?a.$e.addClass("trillo-hidden"):a.$e.removeClass("trillo-hidden")),a.hidden||"none"===a.$e.css("display")||"hidden"===a.$e.css("visibility")?!0:!1)},a.isTrue=function(a,b){var c=a.val;switch(a.op){case"<=":return c>=b;case"<":return c>b;case">=":return b>=c;case">":return b>c}return!1},a.updateWidths=function(a){var b,c;for(c=0;c<a.length;c++)b=a[c],"row"===b.type?this.updateRowWidths(b):"col"===b.type?this.updateColWidths(b):this.updateCellWidths(b)},a.updateRowWidths=function(a){var b,c,d=a.vcl,e=0,f=0;if(d&&d.length>0)for(this.updateWidths(d),c=0;c<d.length;c++)b=d[c],b.minW>e&&(e=b.minW),f+=b.prefW;else 1===a.$e.children().length&&(e=f=this.getMinWidthFormChild(a));a.inputMinW>=0&&(e=a.inputMinW,e>f&&(f=e)),f>a.inputMaxW&&(f=a.inputMaxW),a.minW=e+a.hex,a.prefW=f+a.hex},a.updateColWidths=function(a){var b,c,d=a.vcl,e=0;if(d&&d.length>0)for(this.updateWidths(d),c=0;c<d.length;c++)b=d[c],b.minW>e&&(e=b.minW);else 1===a.$e.children().length&&(e=this.getMinWidthFormChild(a));a.inputMinW>=0&&(e=a.inputMinW),a.minW=a.prefW=e+a.hex},a.updateCellWidths=function(a){a.inputMinW<0?a.prefW=a.minW=Math.ceil(a.$e[0].getBoundingClientRect().width)+a.lm+a.rm:a.prefW=a.minW=a.inputMinW,a.minW>a.inputMaxW&&(a.prefW=a.minW=a.inputMaxW)},a.updateHeights=function(a){var b,c;for(c=0;c<a.length;c++)b=a[c],"cell"===b.type?(b.inputMinH<0?1===b.$e.children().length?b.minH=this.getMinHeightFormChild(b):b.minH=b.$e[0].getBoundingClientRect().height+b.tm+b.bm:b.minH=b.inputMinH,b.minH>b.inputMaxH&&(b.minH=b.inputMaxH)):(b.minH=b.inputMinH,(!b.children||0===b.children.length)&&b.inputMinH<0&&1===b.$e.children().length&&(b.minH=this.getMinHeightFormChild(b)),b.minH>b.inputMaxH&&(b.minH=b.inputMaxH),b.vcl&&this.updateHeights(b.vcl))},a.getMinWidthFormChild=function(a){var b={};return this.setMargins(b,a.$e),Math.ceil(a.$e.children()[0].getBoundingClientRect().width+a.hex+b.lm+b.rm);
},a.getMinHeightFormChild=function(a){var b={};return this.setMargins(b,a.$e),Math.ceil(a.$e.children()[0].getBoundingClientRect().height+a.vex+b.tm+b.bm)},a.computeRowsWidth=function(a,b){var c,d,e;for(d=0;d<a.length;d++)c=a[d],"row"===c.type&&(e=c.inputMaxW<Number.MAX_VALUE?c.inputMaxW:b,c.w=e,this.computeRowChildrenWidth(c,e-c.hex))},a.computeRowChildrenWidth=function(a,b){var c,d,e,f=a.vcl,g=[],h={w:0,l:[]},i=0;if(a.subRows=g,f&&0!==a.minW){for(d=0;d<f.length;d++)c=f[d],c.w=c.minW,e=i+c.minW,this.rowLimit(c,i,b)&&h.l.length&&(h.w=i,g.push(h),h={w:0,l:[]},i=0),i+=c.minW,h.l.push(c);for(h.l.length&&(g.push(h),h.w=i),this.distRowExtraToPref(g,b),this.updateOccupancy(g,b)&&this.distRowExtraToPref(g,b),this.distRowExtraToAll(g,b),d=0;d<f.length;d++)c=f[d],"col"===c.type&&this.computeColChildrenWidth(c)}},a.rowLimit=function(a,b,c){var d=b+a.minW;return d>c},a.computeColChildrenWidth=function(a){var b,c,d=a.vcl;if(d){var e=a.w-a.hex;for(c=0;c<d.length;c++)b=d[c],b.w=e>b.inputMaxW?b.inputMaxW:e,"row"===b.type&&(b.vsl?this.computeRowsWidth(b.vcl,b.w):b.subRows={w:0,l:[]})}},a.updateOccupancy=function(a,b){for(var c,d,e,f,g,h,i=!1,j=a.length-1;j>=1;j--)d=a[j-1],d.l.length<=1||(c=a[j],g=b-c.w,h=b-d.w,f=g-h,e=d.l[d.l.length-1],f>e.w&&(d.l.pop(),d.w-=e.w,c.l.unshift(e),c.w+=e.w));return i&&this.updateOccupancy(a,b),i},a.distRowExtraToPref=function(a,b){for(var c=0;c<a.length;c++)this._distRowExtraToPref(a[c],b)},a._distRowExtraToPref=function(a,b){var c,d,e,f=b-a.w,g=0,h=a.l;if(!(0>=f)){for(d=0;d<h.length;d++)c=h[d],c.w<c.prefW&&(g+=c.prefW-c.w);if(0!==g)for(d=0;d<h.length;d++)c=h[d],c.w<c.prefW&&(e=f*(c.prefW-c.w)/g,e>c.prefW-c.w&&(e=c.prefW-c.w),c.w+=e,a.w+=e)}},a.distRowExtraToAll=function(a,b){for(var c=0;c<a.length;c++)this._distRowExtraToAll(a[c],b)},a._distRowExtraToAll=function(a,b){var c,d,e,f=b-a.w,g=0,h=a.l;if(!(0>=f||0===h.length)){for(d=0;d<h.length;d++)c=h[d],this.updateWidthWeight(c),g+=c.ww;if(0!==g){var i=f;for(d=0;d<h.length;d++)c=h[d],e=f*c.ww/g,c.w+e>c.inputMaxW&&(e=c.inputMaxW-c.w),c.w+=e,a.w+=e,i-=e;Math.floor(i)>1&&i!==f&&this._distRowExtraToAll(a,b)}}},a.updateWidthWeight=function(a){!a.flexWidth||a.w>=a.inputMaxW?a.ww=0:a.ww=a.w},a.setNewWidth=function(a){var b,c;for(c=0;c<a.length;c++)b=a[c],b.$e.outerWidth(Math.round(b.w)-b.lm-b.rm),b.vcl&&this.setNewWidth(b.vcl)},a.computeRowsHeight=function(a){var b;for(b=0;b<a.length;b++)this.computeRowHeight(a[b])},a.computeRowHeight=function(a){var b,c;for(c=0,b=0;b<a.subRows.length;b++)this._computeRowHeight(a.subRows[b]),c+=a.subRows[b].h;a.inputMinH>c&&(c=a.inputMinH),a.h=c+a.vex},a._computeRowHeight=function(a){var b,c,d=a.l,e=0;for(c=0;c<d.length;c++)b=d[c],"col"===b.type?this.computeColHeight(b):b.h=b.minH,e<b.h&&(e=b.h);for(c=0;c<d.length;c++)b=d[c],"col"===b.type&&b.h<e&&this.distColExtraToAll(b.vcl,b.h-b.vex,e),e<b.inputMaxH&&(b.h=e);a.h=e},a.incrRowHeight=function(a,b){var c,d;for(d=0,c=0;c<a.subRows.length;c++)d+=a.subRows[c].h;for(c=0;c<a.subRows.length;c++)this._incrRowHeight(a.subRows[c],a.subRows[c].h*b/d);a.h+=b},a._incrRowHeight=function(a,b){var c,d,e=a.l;for(d=0;d<e.length;d++)c=e[d],"col"===c.type?this.incrColHeight(c,b):c.h+=b;a.h+=b},a.incrColHeight=function(a,b){this.distColExtraToAll(a.vcl,a.h-a.vex,a.h+b),a.h+=b},a.computeColHeight=function(a){var b,c,d=a.vcl,e=0;if(!d||0===d.length)return void(a.h=a.minH>=0?a.minH:0);for(c=0;c<d.length;c++)b=d[c],"row"===b.type?this.computeRowHeight(b):b.h=b.minH,e+=b.h;a.inputMinH>e&&(e=a.inputMinH),a.h=e+a.vex},a.distColExtraToAll=function(a,b,c){var d,e,f,g=c-b;if(!(0>=g)&&a&&0!==a.length){for(e=0;e<a.length;e++)this.updateHeightWeight(a[e]);var h=b,i=g;for(e=0;e<a.length;e++)d=a[e],f=g*d.wh/h,d.h+f>d.inputMaxH&&(f=d.inputMaxH-d.h),f>0&&(b+=f,i-=f,"row"==d.type?this.incrRowHeight(d,f):"col"==d.type?this.incrColHeight(d,f):d.h+=f);Math.floor(i)>1&&i!==g&&this.distColExtraToAll(a,b,c)}},a.updateHeightWeight=function(a){!a.flexHeight||a.h>=a.inputMaxH?a.wh=0:a.wh=a.h},a.positionRows=function(a){var b,c,d=this.gridSpec,e=d.lp+d.lbw,f=d.tp+d.tbw;for(b=0;b<a.length;b++)c=a[b],c.left=e,c.top=f,this.positionRow(c),f+=c.h},a.positionRow=function(a){var b,c,d,e,f,g,h=a.subRows,i=a.tp+a.tbw;for(b=0;b<h.length;b++){for(d=h[b],f=d.l,e=a.lp+a.lbw,c=0;c<f.length;c++)g=f[c],g.top=i,g.left=e,e+=g.w,g.vcl&&this.positionChildren(g);i+=d.h}},a.positionCol=function(a){var b,c,d=a.vcl,e=a.tp+a.tbw;if(d)for(c=0;c<d.length;c++)b=d[c],b.left=a.lp+a.lbw,b.top=e,e+=b.h,b.vcl&&this.positionChildren(b)},a.positionChildren=function(a){"row"===a.type?this.positionRow(a):"col"===a.type&&this.positionCol(a)},a.computeGeometry=function(){this.processShowHideSpecs();var a=this.$gridElem,b=this.makeVisibleList(this.specs),c=this.gridSpec;this.setPaddings(c,a),this.setMargins(c,a),this.setBordersWidth(c,a),this.setNonContentExtra(c),this.updateWidths(b),this.computeRowsWidth(b,a.width()),this.setNewWidth(b),this.updateHeights(b),this.computeRowsHeight(b);for(var d=0,e=0;e<b.length;e++)d+=b[e].h;if(d=Math.floor(d),"page"===this.viewSpec.type){var f=$(window).height()-a.offset().top,g=a.parent().height()-c.vex;g>f&&(g=f),g>d&&(this.distColExtraToAll(b,d,g),d=g)}return a.height(d),this.positionRows(b),b},a._renderFromSpecs=function(a){var b,c,d,e,f,g,h,i;for(d=0;d<a.length;d++)b=a[d],c=b.$e,e=Math.round(b.left),f=Math.round(b.top),g=Math.round(b.w),h=Math.round(b.h),"fixed"===c.css("position")?(i=c.parent().offset(),e+=i.left,f+=i.top):c.css({position:"absolute"}),c.css({left:e+"px",top:f+"px"}),c.outerWidth(g-b.lm-b.rm),c.outerHeight(h-b.tm-b.bm),b.vcl&&this._renderFromSpecs(b.vcl)},a._clipFixedElementHeight=function(a){var b,c,d,e,f,g;for(d=0;d<a.length;d++)b=a[d],c=b.$e,"fixed"===c.css("position")&&(f=Math.round(b.h),g=c.parent().offset(),e=Math.round(b.top)+g.top,e+f>$(window).height()&&(f=$(window).height()-e,c.outerHeight(f-b.tm-b.bm))),b.vcl&&this._clipFixedElementHeight(b.vcl)},a.render=function(){var a=(new Date).getTime(),c=this.$gridElem,d=this.computeGeometry();"static"===c.css("position")&&c.css({position:"relative"}),this._renderFromSpecs(d),this._clipFixedElementHeight(d);var e=(new Date).getTime();b.render.call(this),console.log("Total rendering time: "+(e-a))},a.handleMouseDownOnDragHandle=function(a){var b=this.getParentCell(a.$target);if(b){var c=b.dataOrAttr("id"),d=this.specById(c);d&&(a.userData={cs:d,initialPos:d.$e.position(),initialWidth:d.$e.width(),initialHeight:d.$e.height()},d.$e.addClass("trillo-dragging"))}},a.handleMouseMoveOnDragHandle=function(a){a.userData&&a.userData.cs&&(a.$target.hasClass("js-size-handle")?this.resizing(a):a.$target.hasClass("js-drag-handle")&&this.moving(a))},a.handleMouseUpOnDragHandle=function(a){a.userData&&a.userData.cs&&(a.$target.hasClass("js-size-handle")?this.resizingDone(a):a.$target.hasClass("js-drag-handle")&&this.moveDone(a),a.userData.cs.$e.removeClass("trillo-dragging"))},a.resizing=function(a){var b=a.userData.cs,c=b.$e;c.height(c.height()+a.currentY-a.lastY),c.width(c.width()+a.currentX-a.lastX),b.inputMinW=b.inputMaxW=Math.ceil(b.$e[0].getBoundingClientRect().width)+b.lm+b.rm,b.inputMinH=b.inputMaxH=Math.ceil(b.$e[0].getBoundingClientRect().height)+b.tm+b.bm},a.resizingDone=function(a,b){this.windowResized()},a.moving=function(a){var b=a.userData.cs,c=b.$e,d=c.position();c.css({top:d.top+a.currentY-a.lastY+"px",left:d.left+a.currentX-a.lastX+"px"}),this.updateDropTarget(b,a)},a.moveDone=function(a){var b=a.userData.cs,c=b.$e,d=a.userData.initialPos,e=a.userData.dropTarget;e&&e.parent?(e.$dte.remove(),this.repositionTargetSpecAndElem(a.userData.cs,e),this.windowResized()):c.css({top:d.top+"px",left:d.left+"px"})},a.updateDropTarget=function(a,b){var c=this._getPos(a);c.left=c.left+b.currentX-b.initX,c.top=c.top+b.currentY-b.initY;var d=this.getInnermostContainerRowCol(this.specs,c.left,c.top),e=b.userData.dropTarget;d?(e||(e=b.userData.dropTarget={},e.$dte=$("<div />",{"class":"trillo-drop-target"})),e.parent=d,e.cs=this.getContainerCell(d.vcl,c.left,c.top),b.userData.cs===e.cs?(e.parent=e.cs=null,e.$dte.remove()):(e.position=this.getDropPosition(e.parent,e.cs,c.left,c.top),this.positionDropTargetElem(e))):e&&(e.parent=e.cs=null,e.$dte.remove())},a.getInnermostContainerRowCol=function(a,b,c){var d,e,f;for(e=0;e<a.length;e++)if(d=a[e],("col"===d.type||"row"===d.type)&&this.contains(d,b,c))return d.vcl&&(f=this.getInnermostContainerRowCol(d.vcl,b,c))?f:d;return null},a.getContainerCell=function(a,b,c){var d,e;if(a)for(e=0;e<a.length;e++)if(d=a[e],this.contains(d,b,c))return d;return null},a.contains=function(a,b,c){var d=this._getPos(a),e=d.left,f=d.top,g=e+a.w,h=f+a.h;return b>=e&&g>=b&&c>=f&&h>=c},a._getPos=function(a){for(var b=this.$gridElem.position(),c=0,d=0;a&&this.gridSpec!==a;)c+=a.left,d+=a.top,a=a.parent;return{left:b.left+c,top:b.top+d}},a.getDropPosition=function(a,b,c,d){if(b){var e=this._getPos(b),f=e.left,g=e.top,h=f+b.w,i=g+b.h;return"row"===a.type?h-c>c-f?"left":"right":i-d>d-g?"top":"bottom"}return"none"},a.positionDropTargetElem=function(a){var b=a.parent,c=a.cs,d=a.$dte;if(d.remove(),b.$e.append(d),c){var e=a.position;"left"===e?(d.width("auto"),d.height(c.$e.height()),d.css({left:c.left-d.width()/2+"px",top:c.top+c.tm+"px"})):"right"===e?(d.width("auto"),d.height(c.$e.height()),d.css({left:c.left+c.w-d.width()/2+"px",top:c.top+c.tm+"px"})):"top"===e?(d.height("auto"),d.width(c.$e.width()),d.css({left:c.left+c.lm+"px",top:c.top-d.height()/2+"px"})):"bottom"===e&&(d.height("auto"),d.width(c.$e.width()),d.css({left:c.left+c.lm+"px",top:c.top+c.h-d.height()/2+"px"}))}},a.repositionTargetSpecAndElem=function(a,b){var c=b.parent,d=b.cs,e=a.parent.vcl.indexOf(a);if(a.parent.vcl.splice(e,1),e=a.parent.children.indexOf(a),a.parent.children.splice(e,1),c.children||(c.children=[]),c.vcl||(c.vcl=[]),d){var f=b.position,g=c.vcl.indexOf(d),h=c.children.indexOf(d);"right"===f||"bottom"===f?(g++,h++,a.$e.insertAfter(d.$e)):a.$e.insertBefore(d.$e),c.vcl.splice(g,0,a),c.children.splice(h,0,a)}else c.children.append(a),c.vcl.append(a),c.$e.append(d.$e);a.parent=c},a.getParentCell=function(a){for(var b=a.parent();b&&b.length;){if(b.hasClass("js-flex-cell"))return b;if(b.hasClass("js-flex-row")||b.hasClass("js-flex-col"))return null;b=b.parent()}return null},a.minifyContent=function(a){var b=this.specById(a);b&&(b.hidden=!0,b.top=0,b.left=0,b.w=0,b.h=0,b.$e.addClass("hide"),this.addMinifyIcon(b),this.windowResized())},a.specById=function(a){return this._specById(this.specs,a)},a._specById=function(a,b){for(var c,d=0;d<a.length;d++){if(c=a[d],c.id===b)return c;if(c.children&&(c=this._specById(c.children,b)))return c}return null},a.addMinifyIcon=function(a){this.$iconBar.removeClass("hide");var b=this.$minifyIcon.clone(!0);b.attr("id",a.id),b.attr("title",a.id),this.$iconBar.append(b),b.on("click",$.proxy(this.unminifyContent,this))},a.unminifyContent=function(a){a.stopPropagation(),a.preventDefault();var b=$(a.target),c=b.dataOrAttr("id"),d=this.specById(c);d&&(d.hidden=!1,d.$e.removeClass("hide"),b.remove(),this.windowResized()),0===this.$iconBar.children().length&&this.$iconBar.addClass("hide")},a.windowResized=function(){this.cleared||(this.render(),b.windowResized.call(this))},a.setMargins=function(a,b){a.lm=parseInt(b.css("margin-left"),10),a.rm=parseInt(b.css("margin-right"),10),a.tm=parseInt(b.css("margin-top"),10),a.bm=parseInt(b.css("margin-bottom"),10)},a.setPaddings=function(a,b){a.lp=parseInt(b.css("padding-left"),10),a.rp=parseInt(b.css("padding-right"),10),a.tp=parseInt(b.css("padding-top"),10),a.bp=parseInt(b.css("padding-bottom"),10)},a.setBordersWidth=function(a,b){a.lbw=parseInt(b.css("border-left-width"),10),a.rbw=parseInt(b.css("border-right-width"),10),a.tbw=parseInt(b.css("border-top-width"),10),a.bbw=parseInt(b.css("border-bottom-width"),10)},a.setNonContentExtra=function(a){a.hex=a.lm+a.lp+a.lbw+a.rm+a.rp+a.rbw,a.vex=a.tm+a.tp+a.tbw+a.bm+a.bp+a.bbw},a.layoutContainers=function(){this.cleared||(this.render(),b.layoutContainers.call(this))}}(),function(){"use strict";Trillo.DashboardView=Trillo.inherits(Trillo.FlexGridView,function(a,b,c){Trillo.FlexGridView.call(this,a,b,c)})}(),function(){"use strict";Trillo.DashboardController=Trillo.inherits(Trillo.Controller,function(a){Trillo.Controller.call(this,a)});var a=Trillo.DashboardController.prototype,b=Trillo.Controller.prototype;a.handleAction=function(a,c,d,e){return"minify"===a?(this.minifyView(d),!0):b.handleAction.call(this,a,c)},a.minifyView=function(a){var b=a.closest(".js-flex-cell");this._view.minifyContent&&this._view.minifyContent(b.attr("id"))}}(),function(){"use strict";Trillo.FileUploadC=Trillo.inherits(Trillo.Controller,function(a){Trillo.Controller.call(this,a),this.allowedFileTypes=["jpg","png","gif"],this.allowedFileTypes=a.params.allowedFileTypes||this.allowedFileTypes});var a=Trillo.FileUploadC.prototype;a.postViewShown=function(){var a=this.$elem(),b=this.viewSpec.params||{};this.$fileNameE=a.find('[nm="fileName"]'),this.$file=a.find('[nm="file"]'),this.$file.on("change",$.proxy(this.fileSelected,this)),a.find('[nm="uploadFile"]').on("click",$.proxy(this.uploadFile,this)),a.find("form").attr("action",b.uploadUrl),$.each(b,function(b,c){a.find('[nm="'+b+'"]').val(c)}),this.fileDDH||(this.fileDDH=new Trillo.FileDragDropHandler({parent:this,$dde:a.find(".js-file-drag-drop"),$pb:a.find(".js-progress-bar"),folder:a.find('[nm="folder"]').val(),className:a.find('[nm="className"]').val(),targetViewName:a.find('[nm="targetViewName"]').val(),url:this.viewSpec.params.uploadUrl}))},a.fileSelected=function(){var a=this.$file.val(),b=a.split(".").pop(),c=this.allowedFileTypes.indexOf(b.toLowerCase())<0;this.$fileNameE.val(c?"":a),c?this.showFileUploadError("Unsupported File Type","Only '"+this.allowedFileTypes.join()+"' files are allowed."):this.clearFileUploadError()},a.uploadFile=function(a){return a&&(a.stopPropagation(),a.preventDefault()),""===$.trim(this.$fileNameE.val())?void this.showFileUploadError("Missing File","Please choose a file from your computer to upload."):(this.clearFileUploadError(),Trillo.fileUploadForm=this,void this.$elem().find("form")[0].submit())},a.uploadFileCompletedViaXHR=function(a){var b=this.viewByName(a.targetViewName);a.__viaxhr=!0,b&&b.controller().fileUploadSuccessful(a)},a.postShow=function(){Trillo.alert.clear()},Trillo.FileDragDropHandler=function(a){this.parent=a.parent,this.url=a.url,this.$pb=a.$pb,this.folder=a.folder,this.className=a.className,this.targetViewName=a.targetViewName;var b=this.$dde=a.$dde,c=$.proxy(this.noop,this);b.on("dragenter",c,!1),b.on("dragexit",c,!1),b.on("dragover",c,!1),b.on("drop",$.proxy(this.dropUpload,this))};var b=Trillo.FileDragDropHandler.prototype;b.noop=function(a){a.stopPropagation(),a.preventDefault()},b.dropUpload=function(a){this.noop(a),this.$pb.addClass("trillo-upload-pb-notransition"),this.$pb.width("0%");var b=a.originalEvent.dataTransfer.files,c=this;setTimeout(function(){c.$pb.removeClass("trillo-upload-pb-notransition");for(var a=0;a<b.length;a++)c.upload(b[a])},100)},b.upload=function(a){var b={"image/png":!0,"image/jpeg":!0,"image/gif":!0};if(!b[a.type])return void this.parent.showFileUploadError("Unsupported File Type","Only '"+this.parent.allowedFileTypes.join()+"' files are allowed.");this.parent.clearFileUploadError(),this.$pb.parent().css("visibility","visible"),this.$pb.css("visibility","visible");var c=new FormData;c.append("xhr","1"),c.append("file",a),c.append("folder",this.folder),c.append("className",this.className),c.append("targetViewName",this.targetViewName);var d=new XMLHttpRequest;d.upload.addEventListener("progress",$.proxy(this.uploadProgress,this),!1),d.addEventListener("load",$.proxy(this.uploadComplete,this),!1),d.open("POST",this.url,!0),d.send(c)},b.uploadProgress=function(a){var b=Math.round(a.loaded/a.total*100);this.$pb.width(b+"%")},b.uploadComplete=function(a){var b=$.parseJSON(a.target.responseText);b.error?(this.$pb.width("0%"),this.parent.fileUploadFailed(b)):(this.$pb.width("100%"),this.parent.uploadFileCompletedViaXHR(b))}}(),function(){"use strict";Trillo.Popover=function(a){this.options=a,this.clickM=$.proxy(this.clicked,this),this.clickOutsideM=$.proxy(this.clickedOutside,this),this.setup(a),this.targetInfo={},this.contentInfo={}};var a=Trillo.Popover.prototype;a.setup=function(a){var b,c,d;c=this.$target=a.$target&&a.$target.length?a.$target:null,d=this.$content=a.$content&&a.$content.length?a.$content:null,this.$target||(c=this.$target=this.$content,d=this.$content=null),c&&(b=this.$trigger=a.$trigger,b.on("click",this.clickM),this.contentClass=this._getAttr(b,c,d,"popover-class"),this.hOffset=this._getNumericAttr(b,c,d,"h-offset"),this.vOffset=this._getNumericAttr(b,c,d,"v-offset"),this.alignment=this.getAlignment(this._getAttr(b,c,d,"alignment")),this.$anchor=c.find(".js-popover-anchor"),0===this.$anchor.length&&(this.$anchor=null),this.anchorHOffset=this._getNumericAttr(b,c,d,"anchor-h-offset"),this.anchorVOffset=this._getNumericAttr(b,c,d,"anchor-v-offset"),this.$close=c.find(".js-popover-close"),this.$close.length&&(this.closeClickM=$.proxy(this.closeClicked,this),this.$close.on("click",this.closeClickM)),this.$contentNext=null)},a.clear=function(){this.$trigger.off("click",this.clickM),this.closeClickM&&this.$close.off("click",this.closeClickM),$(document).off("click",this.clickOutsideM)},a.clicked=function(){this.isHidden()?this._show():this._hide()},a.clickedOutside=function(a){$.contains(this.$target[0],a.target)||this.hide()},a.closeClicked=function(){this.hide()},a.show=function(){this.isHidden()&&this._show()},a.hide=function(){this.isHidden()||this._hide()},a._show=function(){if(this.$target){Trillo.popoverManager.hideCurrentPopup(),Trillo.popoverManager.currentPopup=this;var a=this.$trigger,b=this.$target,c=this.$content,d=this.$anchor,e=this.alignment;if(c&&(this.$oldParent=c.parent(),this.$contentNext=c.next(),this.contentClass&&c.addClass(this.contentClass),b.append(c)),this.saveStylesInfo(b,this.targetInfo),this.targetInfo.hasHideClass?b.removeClass("hide"):"none"===this.targetInfo.displayStyle&&b.show(),"hidden"===this.targetInfo.visibilityStyle&&b.css("visibility","visible"),this.targetInfo.hasTrilloHiddenClass&&b.removeClass("trillo-hidden"),c&&(this.saveStylesInfo(c,this.contentInfo),this.contentInfo.hasTrilloHiddenClass&&c.removeClass("trillo-hidden")),e){var f=this.getPosition(a,b,e,this.hOffset,this.vOffset);if(b.offset(f),d){var g=this.getPosition(a,d,e,this.anchorHOffset,this.anchorVOffset);this.adjustPos(b,d,f,g,e),d.css({left:g.left+"px",top:g.top+"px"}),b.offset(f)}}var h=this;setTimeout(function(){$(document).on("click",h.clickOutsideM)},0)}},a.adjustPos=function(a,b,c,d,e){var f=(a.outerWidth(),a.outerHeight()),g=(b.outerWidth(),b.outerHeight());"t"===e.v?(c.top-=g,d.top=f+g,d.left-=c.left):("b"===e.v||"m"===e.v)&&(c.top+=g,d.top=-g,d.left-=c.left)},a._hide=function(){if(this.$target){var a=this.$content;if(this.$oldParent){var b=this.$contentNext;b&&b.length?a.insertBefore(b):this.$oldParent.append(a)}a&&this.contentClass&&a.removeClass(this.contentClass),this.restoreStylesInfo(this.$target,this.targetInfo),a&&this.contentInfo.hasTrilloHiddenClass&&a.addClass("trillo-hidden"),$(document).off("click",this.clickOutsideM)}},a.getPosition=function(a,b,c,d,e){var f=a.offset(),g=a.outerWidth(),h=a.outerHeight(),i=b.outerWidth(),j=b.outerHeight(),k=$(window).width();$(window).height();console.log(f,g,h,i,j);var l=f.top,m=f.left;return"r"===c.h?m+=g-i:"c"===c.h?m+=(g-i)/2:"r"===c.v?m+=g:"l"===c.v&&(m-=i),"t"===c.v?l-=b.outerHeight():"b"===c.v?l+=h:"m"===c.v?l+=h/2:"b"===c.h?l+=h:"m"===c.h&&(l+=(h-j)/2),("r"===c.h||"l"===c.h||"c"===c.h)&&(m+i>k&&(m-=k-(m-i)),0>m&&(m=0)),m+=d,l+=e,{left:m,top:l}},a.getAlignment=function(a){if(a=a?a.toLowerCase():"b-c","none"===a)return null;var b=a.split("-");return{v:b[0]?b[0]:"b",h:b[1]?b[1]:"c"}},a.isHidden=function(){var a=this.$target;if(!a.is(":visible"))return!0;var b=a.offset();return b.left+a.outerWidth()<0||b.top+a.outerHeight()<0},a.saveStylesInfo=function(a,b){b.hasHideClass=a.hasClass("hide"),b.displayStyle=a.css("display"),b.visibilityStyle=a.css("visibility"),b.hasTrilloHiddenClass=a.hasClass("trillo-hidden"),b.offset=a.offset()},a.restoreStylesInfo=function(a,b){b.hasHideClass?a.addClass("hide"):"none"===b.displayStyle&&a.css("display","none"),"hidden"===b.visibilityStyle&&a.css("visibility","hidden"),b.hasTrilloHiddenClass&&a.addClass("trillo-hidden"),this.alignment&&b.offset&&a.css({left:b.offset.left+"px",top:b.offset.top+"px"})},a._getAttr=function(a,b,c,d){var e;return c&&(e=c.dataOrAttr(d))?e:(e=b.dataOrAttr(d),e?e:a.dataOrAttr(d))},a._getNumericAttr=function(a,b,c,d){var e=parseInt(this._getAttr(a,b,c,d),10);return Trillo.isNumeric(e)||(e=0),e},Trillo.PopoverManager=function(){this.currentPopup=null,this.popovers=[]};var b=Trillo.PopoverManager.prototype;b.createPopoverForContent=function(a){var b=a.dataOrAttr("trigger");return b?this.createPopoverForTrigger($(b),a):null},b.createPopoverForTrigger=function(a,b){var c=a.dataOrAttr("target"),d=c?$(c):null;if(!b){var e=a.dataOrAttr("content");b=e?$(e):null}return!d&&b&&(c=b.dataOrAttr("target"),d=c?$(c):null),d||b?this._createPopover(a,d,b):null},b._createPopover=function(a,b,c){var d=new Trillo.Popover({$trigger:a,$target:b,$content:c});return this.popovers.push(d),d},b.showPopup=function(a){this.currentPopup=a,a.show()},b.hideCurrentPopup=function(){this.currentPopup&&this.currentPopup.hide()},b.getPopoverForTrigger=function(a){for(var b=0;b<this.popovers.length;b++)if(this.popovers[b].$trigger[0]===a[0])return this.popovers[b]},b.getPopoverForContent=function(a){for(var b=0;b<this.popovers.length;b++)if(this.popovers[b].$content){if(this.popovers[b].$content[0]===a[0])return this.popovers[b]}else if(this.popovers[b].$target&&this.popovers[b].$target[0]===a[0])return this.popovers[b];return null},b.hasContent=function(a){var b=this.getPopoverForTrigger(a);if(b){var c=b.$content||b.$target;if(c&&c.children(":visible").length>0)return!0}return!1},b.contentCleared=function(a){var b=this.getPopoverForContent(a);b&&b.$trigger.addClass("trillo-trigger-has-no-content")},b.contentShown=function(a){var b=this.getPopoverForContent(a);b&&b.$trigger.removeClass("trillo-trigger-has-no-content")},b.hideCurrentPopupIfContains=function(a){this.currentPopup&&$.contains(this.currentPopup.$target[0],a[0])&&this.hideCurrentPopup()}}();